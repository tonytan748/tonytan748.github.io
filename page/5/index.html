<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Tony Tan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Tony Tan">
<meta name="keywords" content="Tony Tan">
<meta property="og:type" content="website">
<meta property="og:title" content="Tony Tan">
<meta property="og:url" content="https://tonytan748.github.io/page/5/index.html">
<meta property="og:site_name" content="Tony Tan">
<meta property="og:description" content="Tony Tan">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tony Tan">
<meta name="twitter:description" content="Tony Tan">
  
    <link rel="alternate" href="/atom.xml" title="Tony Tan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tony Tan</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">a python progrmmer</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://tonytan748.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Go安装go-redis依赖被墙问题" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/01/20/Go安装go-redis依赖被墙问题/" class="article-date">
  <time datetime="2021-01-20T06:18:57.000Z" itemprop="datePublished">2021-01-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/20/Go安装go-redis依赖被墙问题/">Go安装go-redis依赖被墙问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>GO安装go-redis时，报<code>verifying github.com/go-redis/redis@v6.15.9+incompatible: github.com/go-redis/redis@v6.15.9+incompatible: Get https://sum.golang.org/lookup/github.com/go-redis/redis@v6.15.9+incompatible: dial tcp 108.177.125.141:443: i/o timeout</code>错误。</p>
<p>是由于国内被墙问题导致。</p>
<p>设置<code>GOPROXY</code>为代理地址后再次安装即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">export GOPROXY=https://goproxy.io</span><br><span class="line">go get -u github.com/go-redis/redis/v8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 安装完成后可重设下GOPROXY为空</span><br><span class="line">export GOPROXY=</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2021/01/20/Go安装go-redis依赖被墙问题/" data-id="cm50h3rb90076yfhtkcgiv84i" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2021/01/20/Go安装go-redis依赖被墙问题/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/">go</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-modulesb报错" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/01/11/modulesb报错/" class="article-date">
  <time datetime="2021-01-11T05:19:14.000Z" itemprop="datePublished">2021-01-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/go/">go</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/01/11/modulesb报错/">解决Go中ambiguous import in multiple modules错误</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Gin 中使用gormt将mysql数据库自动生成gorm结构体后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">go get -u -v github.com/xxjwxc/gormt@master</span><br><span class="line">gormt -H=127.0.0.1 -d=oauth_db -p=qwer -u=root --port=3306</span><br></pre></td></tr></table></figure></p>
<p>再此运行Gin时会报<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">build command-line-arguments: cannot load github.com/ugorji/go/codec: ambiguous import: found github.com/ugorji/go/codec in multiple modules:</span><br><span class="line">        github.com/ugorji/go v1.1.4 (/Users/tonytan/go/pkg/mod/github.com/ugorji/go@v1.1.4/codec)</span><br><span class="line">        github.com/ugorji/go/codec v0.0.0-20181209151446-772ced7fd4c2 (/Users/tonytan/go/pkg/mod/github.com/ugorji/go/codec@v0.0.0-20181209151446-772ced7fd4c2)</span><br></pre></td></tr></table></figure></p>
<p>错误.</p>
<p>报错的字面意思是有一个包多个地方引用但版本不一致。</p>
<p>网上查询找到解决方法，详见 <a href="https://github.com/ugorji/go/issues/279。" target="_blank" rel="noopener">https://github.com/ugorji/go/issues/279。</a></p>
<p>1.1.2版本修复了该问题</p>
<p>这时需要运行以下命令：</p>
<p>go get <a href="mailto:github.com/ugorji/go@v1.1.2" target="_blank" rel="noopener">github.com/ugorji/go@v1.1.2</a></p>
<p>已安装了1.1.4，但是还是报错，如果安装1.1.2,则能解决改问题</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2021/01/11/modulesb报错/" data-id="cm50h3rb6006yyfhtk4vum5fi" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2021/01/11/modulesb报错/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/">go</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-后台edite页面实现三级联动" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/30/后台edite页面实现三级联动/" class="article-date">
  <time datetime="2020-12-30T01:45:03.000Z" itemprop="datePublished">2020-12-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/django/">django</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/30/后台edite页面实现三级联动/">后台edite页面实现三级联动</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2><p>在项目中使用Django admin作为后台管理，在店铺表编辑页面需要设置省市区三级联动，查了很多资源，没有发现原生支持的联动方式。 在网上借鉴了别人的写法。</p>
<p>配置：</p>
<ul>
<li><p>Python 3.7</p>
</li>
<li><p>Django3.1</p>
</li>
</ul>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ol>
<li><p>在app文件下创建templates文件夹，创建<code>shop_detail.html</code>用于复写店铺编辑页。 文件名字可自定义。</p>
</li>
<li><p>在app的admin.py中增加并注册ShopAdmin类，在类中增加<code>change_form_template = &quot;shop_detail.html&quot;</code>，指向的html文件名和1中的一致。</p>
</li>
<li><p>从当前python环境中，找到Django包，复制里面的<code>chang_form.html</code>全部内容到前面创建的html中。 该html具体地址为<code>python3.7/site-packages/django/contrib/admin/templates/admin/change_form.html</code>。</p>
</li>
<li><p>编辑<code>shop_detail.html</code></p>
</li>
</ol>
<ul>
<li>将以下ajax请求增加到替换到<code>admin_change_form_document_ready</code>的block中。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">&#123;% block admin_change_form_document_ready %&#125;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">        (function($) &#123;</span><br><span class="line">            $(document).ready(function() &#123;</span><br><span class="line">                $(&apos;.add-another&apos;).click(function(e) &#123;</span><br><span class="line">                    e.preventDefault();</span><br><span class="line">                    var event = $.Event(&apos;django:add-another-related&apos;);</span><br><span class="line">                    $(this).trigger(event);</span><br><span class="line">                    if (!event.isDefaultPrevented()) &#123;</span><br><span class="line">                        showAddAnotherPopup(this);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">            &#123;% if adminform and add %&#125;</span><br><span class="line">                $(&apos;form#&#123;&#123; opts.model_name &#125;&#125;_form :input:visible:enabled:first&apos;).focus()</span><br><span class="line">            &#123;% endif %&#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">            $.get(&apos;/common/choose/province/&apos;,function(p_info)&#123;          // 获取省份接口 这里的地址自定义，已实际的接口地址为准</span><br><span class="line">                var province_info = $(&apos;#id_province&apos;).empty().append(&apos;&lt;option value&gt;&apos;+&apos;---------&apos;+&apos;&lt;/option&gt;&apos;);</span><br><span class="line">                // id_province 已实际的省份字段名为准，可在admin页面中查找</span><br><span class="line">                $.each(p_info.p_lists,function(i,province)&#123;</span><br><span class="line">                    province_info.append(&apos;&lt;option value=&quot;&apos;+province.p_id+&apos;&quot;&gt;&apos;+province.p_name+&apos;&lt;/option&gt;&apos;)</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                $(&apos;#id_province&apos;).change(function()&#123;</span><br><span class="line">                    p_id = $(this).val();</span><br><span class="line">                    $.get(&apos;/common/choose/city/&apos;,&#123;&apos;p_id&apos;:p_id&#125;,function(c_info)&#123;        // 获取城市接口 这里的地址自定义，已实际的接口地址为准</span><br><span class="line">                        var city_info = $(&apos;#id_city&apos;).empty().append(&apos;&lt;option value&gt;&apos;+&apos;---------&apos;+&apos;&lt;/option&gt;&apos;);</span><br><span class="line">                        // id_city 已实际的城市字段名为准，可在admin页面中查找</span><br><span class="line">                        $.each(c_info.c_lists,function(i,city)&#123;</span><br><span class="line">                            city_info.append(&apos;&lt;option value=&quot;&apos;+city.c_id+&apos;&quot;&gt;&apos;+city.c_name+&apos;&lt;/option&gt;&apos;)</span><br><span class="line">                        &#125;)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;);</span><br><span class="line"></span><br><span class="line">                $(&apos;#id_city&apos;).change(function()&#123;</span><br><span class="line">                    c_id = $(this).val();</span><br><span class="line">                    $.get(&apos;/common/choose/area/&apos;,&#123;&quot;c_id&quot;: c_id&#125;,function(a_info)&#123;       // 获取地区接口 这里的地址自定义，已实际的接口地址为准</span><br><span class="line">                        var area_info = $(&apos;#id_district&apos;).empty().append(&apos;&lt;option value&gt;&apos;+&apos;---------&apos;+&apos;&lt;/option&gt;&apos;);</span><br><span class="line">                        // id_district 已实际的地区字段名为准，可在admin页面中查找</span><br><span class="line">                        $.each(a_info.a_lists,function(i,area)&#123;</span><br><span class="line">                            area_info.append(&apos;&lt;option value=&quot;&apos;+area.a_id+&apos;&quot;&gt;&apos;+area.a_name+&apos;&lt;/option&gt;&apos;)</span><br><span class="line">                        &#125;);</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;)(django.jQuery);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>注意里面的省市区字段在page页面中的类名，不确定的话可通过浏览器开发者工具查找。</p>
</li>
<li><p>增加省市区调用接口， 我的地区表在<code>common</code>模块中，同时为避免接口地址冲突，增加了 <code>/choose</code>字段。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">def choose_province(request):</span><br><span class="line">    &quot;&quot;&quot;查询省&quot;&quot;&quot;</span><br><span class="line">    provinces = Area.objects.filter(parent=None)</span><br><span class="line">    p_lists = [&#123;&quot;p_id&quot;: province.id, &quot;p_name&quot;: province.name&#125; for province in provinces]</span><br><span class="line">    p_info = &#123;&quot;p_lists&quot;: p_lists&#125;</span><br><span class="line">    return JsonResponse(p_info, safe=False)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def choose_city(request):</span><br><span class="line">    &quot;&quot;&quot;查询市&quot;&quot;&quot;</span><br><span class="line">    p_id = request.GET.get(&apos;p_id&apos;)</span><br><span class="line">    print(p_id, &apos;--------&apos;)</span><br><span class="line">    if not p_id:</span><br><span class="line">        return JsonResponse(&#123;&#125;, safe=False)</span><br><span class="line">    citys = Area.objects.filter(parent_id=p_id)</span><br><span class="line">    c_lists = [&#123;&quot;c_id&quot;: city.id, &quot;c_name&quot;: city.name&#125; for city in citys]</span><br><span class="line">    print(c_lists[0:5])</span><br><span class="line">    c_info = &#123;&quot;c_lists&quot;: c_lists&#125;</span><br><span class="line">    return JsonResponse(c_info, safe=False)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def choose_area(request):</span><br><span class="line">    &quot;&quot;&quot;查询区&quot;&quot;&quot;</span><br><span class="line">    c_id = request.GET.get(&apos;c_id&apos;)</span><br><span class="line">    print(c_id, &apos;=======&apos;)</span><br><span class="line">    if not c_id:</span><br><span class="line">        return JsonResponse(&#123;&#125;, safe=False)</span><br><span class="line">    areas = Area.objects.filter(parent_id=c_id)</span><br><span class="line">    print(areas)</span><br><span class="line">    a_lists = [&#123;&quot;a_id&quot;: area.id, &quot;a_name&quot;: area.name&#125; for area in areas]</span><br><span class="line">    a_info = &#123;&quot;a_lists&quot;: a_lists&#125;</span><br><span class="line">    print(a_info)</span><br><span class="line">    return JsonResponse(a_info, safe=False)</span><br></pre></td></tr></table></figure>
<ul>
<li>URL地址设置。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">url(r&apos;^choose/province/$&apos;, views.choose_province),</span><br><span class="line">url(r&apos;^choose/city/$&apos;, views.choose_city),</span><br><span class="line">url(r&apos;^choose/area/$&apos;, views.choose_area),</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Django admin功能比较齐全，以前只是按照文档使用，并没有涉及到修改页面。 通过这个3级联动，也清楚了admin的部分原理。对于一些复杂的页面，可以用自定义的形式来重构页面。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2020/12/30/后台edite页面实现三级联动/" data-id="cm50h3rb70071yfhtbtd05m5m" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2020/12/30/后台edite页面实现三级联动/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/">django</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-装饰器的六种写法" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/12/18/装饰器的六种写法/" class="article-date">
  <time datetime="2020-12-18T05:37:49.000Z" itemprop="datePublished">2020-12-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/12/18/装饰器的六种写法/">装饰器的六种写法</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>装饰器本质上是一个Python函数，它可以让其他函数在不需要做任何代码变动的前提下增加额外功能，装饰器的返回值也是一个函数对象。</p>
<p>它经常用于有切面需求的场景，比如：插入日志、性能测试、事务处理、缓存、权限校验等场景。</p>
<p>装饰器是解决这类问题的绝佳设计，有了装饰器，我们就可以抽离出大量与函数功能本身无关的雷同代码并继续重用。</p>
<p>装饰器的使用方法很固定</p>
<ul>
<li><p>先定义一个装饰器（帽子）</p>
</li>
<li><p>再定义你的业务函数或者类（人）</p>
</li>
<li><p>最后把这装饰器（帽子）扣在这个函数（人）头上</p>
</li>
</ul>
<p>就像下面这样子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 定义装饰器</span><br><span class="line">def decorator(func):</span><br><span class="line">    def wrapper(*args, **kw):</span><br><span class="line">        return func()</span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line"># 定义业务函数并进行装饰</span><br><span class="line">@decorator</span><br><span class="line">def function():</span><br><span class="line">    print(&quot;hello, decorator&quot;)</span><br></pre></td></tr></table></figure>
<p>实际上，装饰器并不是编码必须性，意思就是说，你不使用装饰器完全可以，它的出现，应该是使我们的代码</p>
<ul>
<li><p>更加优雅，代码结构更加清晰</p>
</li>
<li><p>将实现特定的功能代码封装成装饰器，提高代码复用率，增强代码可读性</p>
</li>
</ul>
<p>接下来，我将以实例讲解，如何编写出各种简单及复杂的装饰器。</p>
<h1 id="1-普通装饰器"><a href="#1-普通装饰器" class="headerlink" title="1. 普通装饰器"></a>1. 普通装饰器</h1><p>首先咱来写一个最普通的装饰器，它实现的功能是：</p>
<ul>
<li><p>在函数执行前，先记录一行日志</p>
</li>
<li><p>在函数执行完，再记录一行日志</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 这是装饰器函数，参数 func 是被装饰的函数</span><br><span class="line">def logger(func):</span><br><span class="line">    def wrapper(*args, **kw):</span><br><span class="line">        print(&apos;我准备开始执行：&#123;&#125; 函数了:&apos;.format(func.__name__))</span><br><span class="line"></span><br><span class="line">        # 真正执行的是这行。</span><br><span class="line">        func(*args, **kw)</span><br><span class="line"></span><br><span class="line">        print(&apos;主人，我执行完啦。&apos;)</span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@logger</span><br><span class="line">def add(x, y):</span><br><span class="line">    print(&apos;&#123;&#125; + &#123;&#125; = &#123;&#125;&apos;.format(x, y, x+y))</span><br><span class="line"></span><br><span class="line">add(200, 50)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; 我准备开始执行：add 函数了:</span><br><span class="line">&gt;&gt;&gt; 200 + 50 = 250</span><br><span class="line">&gt;&gt;&gt; 我执行完啦。</span><br></pre></td></tr></table></figure>
<h1 id="2-带参数的函数装饰器"><a href="#2-带参数的函数装饰器" class="headerlink" title="2.带参数的函数装饰器"></a>2.带参数的函数装饰器</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">def say_hello(contry):</span><br><span class="line">    def wrapper(func):</span><br><span class="line">        def deco(*args, **kwargs):</span><br><span class="line">            if contry == &quot;china&quot;:</span><br><span class="line">                print(&quot;你好!&quot;)</span><br><span class="line">            elif contry == &quot;america&quot;:</span><br><span class="line">                print(&apos;hello.&apos;)</span><br><span class="line">            else:</span><br><span class="line">                return</span><br><span class="line"></span><br><span class="line">            # 真正执行函数的地方</span><br><span class="line">            func(*args, **kwargs)</span><br><span class="line">        return deco</span><br><span class="line">    return wrapper</span><br><span class="line"></span><br><span class="line"># 小明，中国人</span><br><span class="line">@say_hello(&quot;china&quot;)</span><br><span class="line">def xiaoming():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line"># jack，美国人</span><br><span class="line">@say_hello(&quot;america&quot;)</span><br><span class="line">def jack():</span><br><span class="line">    pass</span><br><span class="line"></span><br><span class="line">xiaoming()</span><br><span class="line">print(&quot;------------&quot;)</span><br><span class="line">jack()</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; 你好!</span><br><span class="line">&gt;&gt;&gt; ------------</span><br><span class="line">&gt;&gt;&gt; hello.</span><br></pre></td></tr></table></figure>
<h1 id="3-不带参数的类装饰器"><a href="#3-不带参数的类装饰器" class="headerlink" title="3. 不带参数的类装饰器"></a>3. 不带参数的类装饰器</h1><p>基于类装饰器的实现，必须实现 <code>__call__</code> 和 <code>__init__</code>两个内置函数。</p>
<ul>
<li><p><code>__init__</code> ：接收被装饰函数</p>
</li>
<li><p><code>__call__</code> ：实现装饰逻辑。</p>
</li>
</ul>
<p>日志打印的例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class logger(object):</span><br><span class="line">    def __init__(self, func):</span><br><span class="line">        self.func = func</span><br><span class="line"></span><br><span class="line">    def __call__(self, *args, **kwargs):</span><br><span class="line">        print(&quot;[INFO]: the function &#123;func&#125;() is running...&quot;\</span><br><span class="line">            .format(func=self.func.__name__))</span><br><span class="line">        return self.func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">@logger</span><br><span class="line">def say(something):</span><br><span class="line">    print(&quot;say &#123;&#125;!&quot;.format(something))</span><br><span class="line"></span><br><span class="line">say(&quot;hello&quot;)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; [INFO]: the function say() is running...</span><br><span class="line">&gt;&gt;&gt; say hello!</span><br></pre></td></tr></table></figure>
<h1 id="4-带参数的类装饰器"><a href="#4-带参数的类装饰器" class="headerlink" title="4. 带参数的类装饰器"></a>4. 带参数的类装饰器</h1><p>带参数和不带参数的类装饰器有很大的不同。</p>
<ul>
<li><p><code>__init__</code> ：不再接收被装饰函数，而是接收传入参数。</p>
</li>
<li><p><code>__call__</code> ：接收被装饰函数，实现装饰逻辑。</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class logger(object):</span><br><span class="line">    def __init__(self, level=&apos;INFO&apos;):</span><br><span class="line">        self.level = level</span><br><span class="line"></span><br><span class="line">    def __call__(self, func): # 接受函数</span><br><span class="line">        def wrapper(*args, **kwargs):</span><br><span class="line">            print(&quot;[&#123;level&#125;]: the function &#123;func&#125;() is running...&quot;\</span><br><span class="line">                .format(level=self.level, func=func.__name__))</span><br><span class="line">            func(*args, **kwargs)</span><br><span class="line">        return wrapper  #返回函数</span><br><span class="line"></span><br><span class="line">@logger(level=&apos;WARNING&apos;)</span><br><span class="line">def say(something):</span><br><span class="line">    print(&quot;say &#123;&#125;!&quot;.format(something))</span><br><span class="line"></span><br><span class="line">say(&quot;hello&quot;)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; [WARNING]: the function say() is running...</span><br><span class="line">&gt;&gt;&gt; say hello!</span><br></pre></td></tr></table></figure>
<h1 id="5-使用偏函数与类实现装饰器"><a href="#5-使用偏函数与类实现装饰器" class="headerlink" title="5. 使用偏函数与类实现装饰器"></a>5. 使用偏函数与类实现装饰器</h1><p>Python 对某个对象是否能通过装饰器（<code>@decorator</code>）形式使用只有一个要求：<code>decorator</code> 必须是一个“可被调用（<code>callable</code>）”的对象。</p>
<p>对于这个 <code>callable</code> 对象，我们最熟悉的就是函数了。</p>
<p>除函数之外，类也可以是 <code>callable</code> 对象，只要实现了<code>__call__</code> 函数（上面几个例子已经接触过了）。</p>
<p>还有容易被人忽略的偏函数其实也是 <code>callable</code> 对象。</p>
<p>接下来就来说说，如何使用 类和偏函数结合实现一个与众不同的装饰器。</p>
<p>示例： <code>DelayFunc</code> 是一个实现了 <code>__call__</code> 的类，<code>delay</code> 返回一个偏函数，在这里 <code>delay</code> 就可以做为一个装饰器。（以下代码摘自 Python工匠：使用装饰器的小技巧）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">import functools</span><br><span class="line"></span><br><span class="line">class DelayFunc:</span><br><span class="line">    def __init__(self,  duration, func):</span><br><span class="line">        self.duration = duration</span><br><span class="line">        self.func = func</span><br><span class="line"></span><br><span class="line">    def __call__(self, *args, **kwargs):</span><br><span class="line">        print(f&apos;Wait for &#123;self.duration&#125; seconds...&apos;)</span><br><span class="line">        time.sleep(self.duration)</span><br><span class="line">        return self.func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    def eager_call(self, *args, **kwargs):</span><br><span class="line">        print(&apos;Call without delay&apos;)</span><br><span class="line">        return self.func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">def delay(duration):</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    装饰器：推迟某个函数的执行。</span><br><span class="line">    同时提供 .eager_call 方法立即执行</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    # 此处为了避免定义额外函数，</span><br><span class="line">    # 直接使用 functools.partial 帮助构造 DelayFunc 实例</span><br><span class="line">    return functools.partial(DelayFunc, duration)</span><br><span class="line"></span><br><span class="line"># 使用</span><br><span class="line">@delay(duration=2)</span><br><span class="line">def add(a, b):</span><br><span class="line">    return a+b</span><br><span class="line"></span><br><span class="line"># 执行过程</span><br><span class="line">&gt;&gt;&gt; add    # 可见 add 变成了 Delay 的实例</span><br><span class="line">&lt;__main__.DelayFunc object at 0x107bd0be0&gt;</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; add(3,5)  # 直接调用实例，进入 __call__</span><br><span class="line">Wait for 2 seconds...</span><br><span class="line">8</span><br><span class="line">&gt;&gt;&gt; </span><br><span class="line">&gt;&gt;&gt; add.func # 实现实例方法</span><br><span class="line">&lt;function add at 0x107bef1e0&gt;</span><br></pre></td></tr></table></figure>
<h1 id="6-能装饰类的装饰器"><a href="#6-能装饰类的装饰器" class="headerlink" title="6. 能装饰类的装饰器"></a>6. 能装饰类的装饰器</h1><p>装饰器版的单例写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">instances = &#123;&#125;</span><br><span class="line"></span><br><span class="line">def singleton(cls):</span><br><span class="line">    def get_instance(*args, **kw):</span><br><span class="line">        cls_name = cls.__name__</span><br><span class="line">        print(&apos;===== 1 ====&apos;)</span><br><span class="line">        if not cls_name in instances:</span><br><span class="line">            print(&apos;===== 2 ====&apos;)</span><br><span class="line">            instance = cls(*args, **kw)</span><br><span class="line">            instances[cls_name] = instance</span><br><span class="line">        return instances[cls_name]</span><br><span class="line">    return get_instance</span><br><span class="line"></span><br><span class="line">@singleton</span><br><span class="line">class User:</span><br><span class="line">    _instance = None</span><br><span class="line">    def __init__(self, name):</span><br><span class="line">        print(&apos;===== 3 ====&apos;)</span><br><span class="line">        self.name = name</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2020/12/18/装饰器的六种写法/" data-id="cm50h3rb4006vyfht1762x0qa" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2020/12/18/装饰器的六种写法/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-How-to-set-up-a-perfect-Python-project" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/09/How-to-set-up-a-perfect-Python-project/" class="article-date">
  <time datetime="2020-11-09T03:13:21.000Z" itemprop="datePublished">2020-11-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/11/09/How-to-set-up-a-perfect-Python-project/">How to set up a perfect Python project</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>This blog is from <a href="https://sourcery.ai/blog/python-best-practices/" target="_blank" rel="noopener">here</a></p>
<p>When starting a new Python project, it is tempting to just dive in and start coding. Spending a tiny amount of time to setup a project with the best tools will save immense time and lead to a happier coding experience.</p>
<p>In an ideal world, dependencies would be identical for all developers, code would be perfectly formatted, common errors forbidden and everything would be covered by tests. Additionally, all of these would ensured at each commit.</p>
<p>In this article I’ll go through how to set up a project that does exactly that. You can either follow along with the steps or jump straight to generating a new project automatically by installing <a href="https://sourcery.ai/blog/python-best-practices/#pipx" target="_blank" rel="noopener">pipx</a> and <a href="https://sourcery.ai/blog/python-best-practices/#pipenv" target="_blank" rel="noopener">pipenv</a> then <a href="https://sourcery.ai/blog/python-best-practices/#pipenv" target="_blank" rel="noopener">generating a new project</a>.</p>
<p>Let’s create a new project directory:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir best_practices</span><br><span class="line">cd best_practices</span><br></pre></td></tr></table></figure>
<h1 id="Python-command-line-tools-with-pipx"><a href="#Python-command-line-tools-with-pipx" class="headerlink" title="Python command line tools with pipx"></a>Python command line tools with pipx</h1><p><a href="https://pipxproject.github.io/pipx/" target="_blank" rel="noopener">Pipx</a> is a handy utility that allows quick installation of python command line tools. We’ll be using it to install pipenv and cookiecutter.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 -m pip install --user pipx</span><br><span class="line">python3 -m pipx ensurepath</span><br></pre></td></tr></table></figure>
<h1 id="Dependency-management-with-pipenv"><a href="#Dependency-management-with-pipenv" class="headerlink" title="Dependency management with pipenv"></a>Dependency management with pipenv</h1><blockquote>
<p><a href="https://github.com/pypa/pipenv" target="_blank" rel="noopener">Pipenv</a> automatically creates and manages a virtualenv for your projects, as well as adding/removing packages from your Pipfile as you install/uninstall packages. It also generates the ever-important Pipfile.lock, which is used to produce deterministic builds.</p>
</blockquote>
<p>Knowing that you and your teammates are using the same library versions is a huge confidence boost. Pipenv takes care of this and has gained massive traction in the last year or so.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipx install pipenv</span><br></pre></td></tr></table></figure>
<h1 id="Code-formatting-with-black-and-isort"><a href="#Code-formatting-with-black-and-isort" class="headerlink" title="Code formatting with black and isort"></a>Code formatting with black and isort</h1><p><a href="https://github.com/psf/black" target="_blank" rel="noopener">Black</a> formats our code:</p>
<blockquote>
<p>Black is the uncompromising Python code formatter. By using it, you agree to cede control over minutiae of hand-formatting. In return, Black gives you speed, determinism, and freedom from pycodestyle nagging about formatting. You will save time and mental energy for more important matters.<br>Blackened code looks the same regardless of the project you’re reading. Formatting becomes transparent after a while and you can focus on the content instead.<br>Black makes code review faster by producing the smallest diffs possible.</p>
</blockquote>
<p>while <a href="https://github.com/timothycrosley/isort" target="_blank" rel="noopener">isort</a> sorts our imports:</p>
<blockquote>
<p>isort your python imports for you so you don’t have to. isort is a Python utility / library to sort imports alphabetically, and automatically separated into sections.</p>
</blockquote>
<p>Let’s install them using pipenv as development dependencies so they don’t clutter a deployment:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install black isort --dev</span><br></pre></td></tr></table></figure>
<p>Black and isort have incompatible default options so we’ll override isort to follow black’s lead. Create a <code>setup.cfg</code> file and add this config:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[isort]</span><br><span class="line">multi_line_output=3</span><br><span class="line">include_trailing_comma=True</span><br><span class="line">force_grid_wrap=0</span><br><span class="line">use_parentheses=True</span><br><span class="line">line_length=88</span><br></pre></td></tr></table></figure>
<p>We can run these tools with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pipenv run black</span><br><span class="line">pipenv run isort</span><br></pre></td></tr></table></figure>
<h1 id="Style-enforcement-with-flake8"><a href="#Style-enforcement-with-flake8" class="headerlink" title="Style enforcement with flake8"></a>Style enforcement with flake8</h1><p>Flake8 ensures our code follows the standard python conventions as defined in PEP8. Install using pipenv:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install flake8 --dev</span><br></pre></td></tr></table></figure>
<p>Just like isort it needs a little configuration to work well with black. Add this config to <code>setup.cfg</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[flake8]</span><br><span class="line">ignore = E203, E266, E501, W503</span><br><span class="line">max-line-length = 88</span><br><span class="line">max-complexity = 18</span><br><span class="line">select = B,C,E,F,W,T4</span><br></pre></td></tr></table></figure>
<p>Now we can run flake8 with pipenv run flake8.</p>
<h1 id="Static-types-with-mypy"><a href="#Static-types-with-mypy" class="headerlink" title="Static types with mypy"></a>Static types with mypy</h1><blockquote>
<p><a href="http://mypy-lang.org/" target="_blank" rel="noopener">Mypy</a> is an optional static type checker for Python that aims to combine the benefits of dynamic (or “duck”) typing and static typing. Mypy combines the expressive power and convenience of Python with a powerful type system and compile-time type checking. Mypy type checks standard Python programs; run them using any Python VM with basically no runtime overhead.</p>
</blockquote>
<p>Having types in Python takes a little getting used to but the benefits are substantial. From the website:</p>
<ul>
<li>Static typing can make programs easier to understand and maintain</li>
<li>Static typing can help you find bugs earlier and with less testing and debugging</li>
<li>Static typing can help you find difficult-to-find bugs before your code goes into production</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install mypy --dev</span><br></pre></td></tr></table></figure>
<p>Mypy by default will recursively check all imports for type annotations which leads to errors when libraries do not include these annotations. We need to configure mypy to run only on our code and to ignore any errors for imports without type annotations. We are assuming that our code lives in the best_practices package for the following config. Add this to <code>setup.cfg</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mypy]</span><br><span class="line">files=best_practices,test</span><br><span class="line">ignore_missing_imports=true</span><br></pre></td></tr></table></figure>
<p>Now we can run mypy with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv run mypy</span><br></pre></td></tr></table></figure>
<p>Here’s a useful <a href="https://mypy.readthedocs.io/en/latest/cheat_sheet_py3.html" target="_blank" rel="noopener">cheat sheet</a> for using it.</p>
<h1 id="Testing-with-pytest-and-pytest-cov"><a href="#Testing-with-pytest-and-pytest-cov" class="headerlink" title="Testing with pytest and pytest-cov"></a>Testing with pytest and pytest-cov</h1><p>Writing tests with <a href="https://docs.pytest.org/en/latest/" target="_blank" rel="noopener">pytest</a> is incredibly easy and removing any friction to writing tests means we will write more of them!</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv install pytest pytest-cov --dev</span><br></pre></td></tr></table></figure>
<p>Here’s a simple example from the pytest website:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># content of test_sample.py</span><br><span class="line">def inc(x):</span><br><span class="line">    return x + 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def test_answer():</span><br><span class="line">    assert inc(3) == 5</span><br></pre></td></tr></table></figure>
<p>To execute it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ pipenv run pytest</span><br><span class="line">=========================== test session starts ============================</span><br><span class="line">platform linux -- Python 3.x.y, pytest-5.x.y, py-1.x.y, pluggy-0.x.y</span><br><span class="line">cachedir: $PYTHON_PREFIX/.pytest_cache</span><br><span class="line">rootdir: $REGENDOC_TMPDIR</span><br><span class="line">collected 1 item</span><br><span class="line"></span><br><span class="line">test_sample.py F                                                     [100%]</span><br><span class="line"></span><br><span class="line">================================= FAILURES =================================</span><br><span class="line">_______________________________ test_answer ________________________________</span><br><span class="line"></span><br><span class="line">    def test_answer():</span><br><span class="line">&gt;       assert inc(3) == 5</span><br><span class="line">E       assert 4 == 5</span><br><span class="line">E        +  where 4 = inc(3)</span><br><span class="line"></span><br><span class="line">test_sample.py:6: AssertionError</span><br><span class="line">========================= 1 failed in 0.12 seconds =========================</span><br></pre></td></tr></table></figure>
<p>All our tests should go in the <code>test</code> directory so add this config to <code>setup.cfg</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[tool:pytest]</span><br><span class="line">testpaths=test</span><br></pre></td></tr></table></figure>
<p>We also want to check how much of our code is covered by tests. Create a new file <code>.coveragerc</code> to only return coverage statistics for our application code, again we are assuming our application code lives in the <code>best_practices</code> module:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[run]</span><br><span class="line">source = best_practices</span><br><span class="line"></span><br><span class="line">[report]</span><br><span class="line">exclude_lines =</span><br><span class="line">    # Have to re-enable the standard pragma</span><br><span class="line">    pragma: no cover</span><br><span class="line"></span><br><span class="line">    # Don&apos;t complain about missing debug-only code:</span><br><span class="line">    def __repr__</span><br><span class="line">    if self\.debug</span><br><span class="line"></span><br><span class="line">    # Don&apos;t complain if tests don&apos;t hit defensive assertion code:</span><br><span class="line">    raise AssertionError</span><br><span class="line">    raise NotImplementedError</span><br><span class="line"></span><br><span class="line">    # Don&apos;t complain if non-runnable code isn&apos;t run:</span><br><span class="line">    if 0:</span><br><span class="line">    if __name__ == .__main__.:</span><br></pre></td></tr></table></figure>
<p>We can now run our tests and report coverage with</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv run pytest --cov --cov-fail-under=100</span><br></pre></td></tr></table></figure>
<p>This will fail if our test coverage of the application code is less than 100%.</p>
<h1 id="Git-hooks-with-pre-commit"><a href="#Git-hooks-with-pre-commit" class="headerlink" title="Git hooks with pre-commit"></a>Git hooks with pre-commit</h1><p>Git hooks allow you to run scripts any time you want to commit or push. This lets us run all of our linting and tests automatically every time we commit/push. <a href="https://pre-commit.com/" target="_blank" rel="noopener">pre‑commit</a> allows easy configuration of these hooks:</p>
<blockquote>
<p>Git hook scripts are useful for identifying simple issues before submission to code review. We run our hooks on every commit to automatically point out issues in code such as missing semicolons, trailing whitespace, and debug statements. By pointing these issues out before code review, this allows a code reviewer to focus on the architecture of a change while not wasting time with trivial style nitpicks.</p>
</blockquote>
<p>Here we configure all of the above tools to run on any changed python files on committing, and also to run pytest coverage only when pushing as it can be slow. Create a new file <code>.pre-commit-config.yaml</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">repos:</span><br><span class="line">  - repo: local</span><br><span class="line">    hooks:</span><br><span class="line">      - id: isort</span><br><span class="line">        name: isort</span><br><span class="line">        stages: [commit]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run isort</span><br><span class="line">        types: [python]</span><br><span class="line"></span><br><span class="line">      - id: black</span><br><span class="line">        name: black</span><br><span class="line">        stages: [commit]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run black</span><br><span class="line">        types: [python]</span><br><span class="line"></span><br><span class="line">      - id: flake8</span><br><span class="line">        name: flake8</span><br><span class="line">        stages: [commit]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run flake8</span><br><span class="line">        types: [python]</span><br><span class="line">        exclude: setup.py</span><br><span class="line"></span><br><span class="line">      - id: mypy</span><br><span class="line">        name: mypy</span><br><span class="line">        stages: [commit]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run mypy</span><br><span class="line">        types: [python]</span><br><span class="line">        pass_filenames: false</span><br><span class="line"></span><br><span class="line">      - id: pytest</span><br><span class="line">        name: pytest</span><br><span class="line">        stages: [commit]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run pytest</span><br><span class="line">        types: [python]</span><br><span class="line"></span><br><span class="line">      - id: pytest-cov</span><br><span class="line">        name: pytest</span><br><span class="line">        stages: [push]</span><br><span class="line">        language: system</span><br><span class="line">        entry: pipenv run pytest --cov --cov-fail-under=100</span><br><span class="line">        types: [python]</span><br><span class="line">        pass_filenames: false</span><br></pre></td></tr></table></figure>
<p>If you ever need to skip these hooks you can run <code>git commit --no-verify</code> or <code>git push --no-verify</code></p>
<h1 id="Generate-a-project-using-cookiecutter"><a href="#Generate-a-project-using-cookiecutter" class="headerlink" title="Generate a project using cookiecutter"></a>Generate a project using cookiecutter</h1><p>Now we’ve seen what an ideal project contains, we can turn this into a <a href="https://github.com/sourcery-ai/python-best-practices-cookiecutter" target="_blank" rel="noopener">template</a> to generate a new project with a single command:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipx run cookiecutter gh:sourcery-ai/python-best-practices-cookiecutter</span><br></pre></td></tr></table></figure>
<p>Fill in the project name and repo name and your project will be generated for you.</p>
<p>To finish setting up, follow these steps:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># Enter project directory</span><br><span class="line">cd &lt;repo_name&gt;</span><br><span class="line"></span><br><span class="line"># Initialise git repo</span><br><span class="line">git init</span><br><span class="line"></span><br><span class="line"># Install dependencies</span><br><span class="line">pipenv install --dev</span><br><span class="line"></span><br><span class="line"># Setup pre-commit and pre-push hooks</span><br><span class="line">pipenv run pre-commit install -t pre-commit</span><br><span class="line">pipenv run pre-commit install -t pre-push</span><br></pre></td></tr></table></figure>
<p>The template project contains a very simple Python file and test to try the tools out on. Once you’re happy with the code you can then do your first <code>git commit</code> and all the hooks will be run.</p>
<h1 id="Editor-Integration"><a href="#Editor-Integration" class="headerlink" title="Editor Integration"></a>Editor Integration</h1><p>While it is great to know that the standard of code on our project will always be maintained at the highest level when committing code, it is somewhat frustrating to find out any issues after we think the code changes have all been done. It is much better to get the issues displayed in real-time.</p>
<p>Spend some time to make sure these commands are run by your code editor when saving a file. Having instant feedback means you can quickly fixup any minor issues introduced while the code is fresh in the mind.</p>
<p>Personally I use some excellent Vim plugins to accomplish this:</p>
<ul>
<li><a href="https://github.com/dense-analysis/ale" target="_blank" rel="noopener">ale</a> runs flake8 in real-time, and runs black, isort and mypy on file save</li>
<li><a href="https://github.com/janko/vim-test" target="_blank" rel="noopener">vim-test</a> with <a href="https://github.com/janko/vim-test#projectionist-integration" target="_blank" rel="noopener">projectionist integration</a> runs pytest on file save</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2020/11/09/How-to-set-up-a-perfect-Python-project/" data-id="cm50h3rb0006oyfhta9yo5im1" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2020/11/09/How-to-set-up-a-perfect-Python-project/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Python-datetime模块介绍及示例" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/17/Python-datetime模块介绍及示例/" class="article-date">
  <time datetime="2019-05-17T02:00:55.000Z" itemprop="datePublished">2019-05-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/17/Python-datetime模块介绍及示例/">Python datetime模块介绍及示例</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>转载自<a href="https://blog.csdn.net/cmzsteven/article/details/64906245" target="_blank" rel="noopener">这里</a></p>
<h1 id="datetime模块介绍"><a href="#datetime模块介绍" class="headerlink" title="datetime模块介绍"></a>datetime模块介绍</h1><h2 id="datetime模块中包含如下类："><a href="#datetime模块中包含如下类：" class="headerlink" title="datetime模块中包含如下类："></a>datetime模块中包含如下类：</h2><table>
<thead>
<tr>
<th>类名</th>
<th>功能说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td>日期对象,常用的属性有year, month, day</td>
</tr>
<tr>
<td>time</td>
<td>时间对象</td>
</tr>
<tr>
<td>datetime</td>
<td>日期时间对象,常用的属性有hour, minute, second, microsecond</td>
</tr>
<tr>
<td>datetime_CAPI</td>
<td>日期时间对象C语言接口</td>
</tr>
<tr>
<td>timedelta</td>
<td>时间间隔，即两个时间点之间的长度</td>
</tr>
<tr>
<td>tzinfo</td>
<td>时区信息对象</td>
</tr>
</tbody>
</table>
<h2 id="datetime模块中包含的常量"><a href="#datetime模块中包含的常量" class="headerlink" title="datetime模块中包含的常量"></a>datetime模块中包含的常量</h2><table>
<thead>
<tr>
<th>常量</th>
<th>功能说明</th>
<th>用法</th>
<th>返回值</th>
</tr>
</thead>
<tbody>
<tr>
<td>MAXYEAR</td>
<td>返回能表示的最大年份</td>
<td>datetime.MAXYEAR</td>
<td>9999</td>
</tr>
<tr>
<td>MINYEAR</td>
<td>返回能表示的最小年份</td>
<td>datetime.MINYEAR</td>
<td>1</td>
</tr>
</tbody>
</table>
<h1 id="date类"><a href="#date类" class="headerlink" title="date类"></a>date类</h1><h2 id="date对象构成"><a href="#date对象构成" class="headerlink" title="date对象构成"></a>date对象构成</h2><ul>
<li>date对象由year年份、month月份及day日期三部分构成：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date（year，month，day)</span><br></pre></td></tr></table></figure>
<ul>
<li>通过<code>year</code>, <code>month</code>, <code>day</code>三个数据描述符可以进行访问：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date.today()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; a.year</span><br><span class="line">2017</span><br><span class="line">&gt;&gt;&gt; a.month</span><br><span class="line">3</span><br><span class="line">&gt;&gt;&gt; a.day</span><br><span class="line">22</span><br></pre></td></tr></table></figure>
<ul>
<li>当然，你也可以用<code>__getattribute__(...)</code>方法获得上述值：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;year&apos;)</span><br><span class="line">2017</span><br><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;month&apos;)</span><br><span class="line">3</span><br><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;day&apos;)</span><br><span class="line">22</span><br></pre></td></tr></table></figure>
<h2 id="date对象中包含的方法与属性"><a href="#date对象中包含的方法与属性" class="headerlink" title="date对象中包含的方法与属性"></a>date对象中包含的方法与属性</h2><ul>
<li>用于日期比较大小的方法</li>
</ul>
<table>
<thead>
<tr>
<th>方法名</th>
<th>方法说明</th>
<th>用法</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__eq__(…)</code></td>
<td>等于(x==y)</td>
<td>`x.<strong>eq</strong>(y)</td>
<td>`</td>
</tr>
<tr>
<td><code>__ge__(…)</code></td>
<td>大于等于(x&gt;=y)</td>
<td><code>x.__ge__(y)</code></td>
</tr>
<tr>
<td><code>__gt__(…)</code></td>
<td>大于(x&gt;y)</td>
<td><code>x.__gt__(y)</code></td>
</tr>
<tr>
<td><code>__le__(…)</code></td>
<td>小于等于(x&lt;=y)</td>
<td><code>x.__le__(y)</code></td>
</tr>
<tr>
<td><code>__lt__(…)</code></td>
<td>小于(x</td>
<td><code>x.__lt__(y)</code></td>
</tr>
<tr>
<td><code>__ne__(…)</code></td>
<td>不等于(x!=y)</td>
<td><code>x.__ne__(y)</code></td>
</tr>
</tbody>
</table>
<p>以上方法的返回值为True\False</p>
<p>示例如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a=datetime.date(2017,3,1)</span><br><span class="line">&gt;&gt;&gt; b=datetime.date(2017,3,15)</span><br><span class="line">&gt;&gt;&gt; a.__eq__(b)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; a.__ge__(b)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; a.__gt__(b)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; a.__le__(b)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; a.__lt__(b)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; a.__ne__(b)</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
<ul>
<li>获得二个日期相差多少天</li>
</ul>
<p>使用<code>__sub__(...)</code>和<code>__rsub__(...)</code>方法，其实二个方法差不太多，一个是正向操作，一个是反向操作：</p>
<table>
<thead>
<tr>
<th>方法名</th>
<th>方法说明</th>
<th>用法</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>sub</strong>(…)</td>
<td>x - y</td>
<td>x.<strong>sub</strong>(y)</td>
</tr>
<tr>
<td><strong>rsub</strong>(…)</td>
<td>y - x</td>
<td>x.<strong>rsub</strong>(y)</td>
</tr>
</tbody>
</table>
<p>示例如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">datetime.date(2017, 3, 15)</span><br><span class="line">&gt;&gt;&gt; a.__sub__(b)</span><br><span class="line">datetime.timedelta(7)</span><br><span class="line">&gt;&gt;&gt; a.__rsub__(b)</span><br><span class="line">datetime.timedelta(-7)</span><br></pre></td></tr></table></figure></p>
<p>计算结果的返回值类型为<code>datetime.timedelta</code>, 如果获得整数类型的结果则按下面的方法操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.__sub__(b).days</span><br><span class="line">7</span><br><span class="line">&gt;&gt;&gt; a.__rsub__(b).days</span><br><span class="line">-7</span><br></pre></td></tr></table></figure>
<ul>
<li><p>ISO标准化日期</p>
<p>  如果想要让所使用的日期符合ISO标准，那么使用如下三个方法: </p>
<ul>
<li><p><code>isocalendar(...)</code>:返回一个包含三个值的元组，三个值依次为：year年份，week number周数，weekday星期数（周一为1…周日为7)： </p>
<p>示例如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.isocalendar()</span><br><span class="line">(2017, 12, 3)</span><br><span class="line">&gt;&gt;&gt; a.isocalendar()[0]</span><br><span class="line">2017</span><br><span class="line">&gt;&gt;&gt; a.isocalendar()[1]</span><br><span class="line">12</span><br><span class="line">&gt;&gt;&gt; a.isocalendar()[2]</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
</li>
<li><p>isoformat(…): 返回符合ISO 8601标准 (YYYY-MM-DD) 的日期字符串； </p>
<p>示例如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.isoformat()</span><br><span class="line">&apos;2017-03-22&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>isoweekday(…): 返回符合ISO标准的指定日期所在的星期数（周一为1…周日为7) </p>
<p>示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.isoweekday()</span><br><span class="line">3</span><br></pre></td></tr></table></figure>
</li>
<li><p>与isoweekday(…)相似的还有一个weekday(…)方法，只不过是weekday(…)方法返回的周一为 0, 周日为 6 </p>
<p>示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.weekday()</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>其他方法与属性</p>
<ul>
<li><p><code>timetuple(...)</code>:该方法为了兼容<code>time.localtime(...)</code>返回一个类型为<code>time.struct_time</code>的数组，但有关时间的部分元素值为0：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.timetuple()</span><br><span class="line">time.struct_time(tm_year=2017, tm_mon=3, tm_mday=22, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=2, tm_yday=81, tm_isdst=-1)</span><br><span class="line">&gt;&gt;&gt; a.timetuple().tm_year</span><br><span class="line">2017</span><br><span class="line">&gt;&gt;&gt; a.timetuple().tm_mon</span><br><span class="line">3</span><br><span class="line">&gt;&gt;&gt; a.timetuple().tm_mday</span><br><span class="line">22</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>toordinal(...)</code>： 返回公元公历开始到现在的天数。公元1年1月1日为1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.toordinal()</span><br><span class="line">736410</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>replace(...)</code>：返回一个替换指定日期字段的新date对象。参数3个可选参数，分别为year,month,day。注意替换是产生新对象，不影响原date对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; b = a.replace(2017,2,28)</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; b</span><br><span class="line">datetime.date(2017, 2, 28)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>resolution</code>：date对象表示日期的最小单位。这里是天。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.date.resolution</span><br><span class="line">datetime.timedelta(1)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>fromordinal(...)</code>：将Gregorian日历时间转换为date对象；Gregorian Calendar ：一种日历表示方法，类似于我国的农历，西方国家使用比较多。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; b = a.toordinal()</span><br><span class="line">&gt;&gt;&gt; datetime.date.fromordinal(b)</span><br><span class="line">datetime.date(2017, 3, 22)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>fromtimestamp(...)</code>：根据给定的时间戮，返回一个date对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; time.time()</span><br><span class="line">1490165087.2242179</span><br><span class="line">&gt;&gt;&gt; datetime.date.fromtimestamp(time.time())</span><br><span class="line">datetime.date(2017, 3, 22)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>today(...)</code>：返回当前日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.date.today()</span><br><span class="line">datetime.date(2017, 3, 22)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>max</code>： date类能表示的最大的年、月、日的数值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.date.max</span><br><span class="line">datetime.date(9999, 12, 31)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>min</code>： date类能表示的最小的年、月、日的数值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.date.min</span><br><span class="line">datetime.date(1, 1, 1)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="日期的字符串输出"><a href="#日期的字符串输出" class="headerlink" title="日期的字符串输出"></a>日期的字符串输出</h2><ul>
<li><p>如果你想将日期对象转化为字符串对象的话，可以用到<code>__format__(...)</code>方法以指定格式进行日期输出：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.date(2017,3,22)</span><br><span class="line">&gt;&gt;&gt; a.__format__(&apos;%Y-%m-%d&apos;)</span><br><span class="line">&apos;2017-03-22&apos;</span><br><span class="line">&gt;&gt;&gt; a.__format__(&apos;%Y/%m/%d&apos;)</span><br><span class="line">&apos;2017/03/22&apos;</span><br><span class="line">&gt;&gt;&gt; a.__format__(&apos;%y/%m/%d&apos;)</span><br><span class="line">&apos;17/03/22&apos;</span><br><span class="line">&gt;&gt;&gt; a.__format__(&apos;%D&apos;)</span><br><span class="line">&apos;03/22/17&apos;</span><br></pre></td></tr></table></figure>
<p>  与此方法等价的方法为strftime(…)</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.strftime(&quot;%Y%m%d&quot;)</span><br><span class="line">&apos;20170322&apos;</span><br></pre></td></tr></table></figure>
<p>  关于格式化字符串的相关内容，请查阅本文最后的：附录：python中时间日期格式化符号</p>
</li>
<li><p>如果只是相简单的获得日期的字符串，则使用<code>__str__(...)</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.__str__()</span><br><span class="line">&apos;2017-03-22&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果想要获得ctime样式的格式请使用<code>ctime(...)</code>:</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.ctime()</span><br><span class="line">&apos;Wed Mar 22 00:00:00 2017&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="time类"><a href="#time类" class="headerlink" title="time类"></a>time类</h1><h2 id="time类的数据构成"><a href="#time类的数据构成" class="headerlink" title="time类的数据构成"></a>time类的数据构成</h2><p>time类由hour小时、minute分钟、second秒、microsecond毫秒和tzinfo五部分组成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time([hour[, minute[, second[, microsecond[, tzinfo]]]]])</span><br></pre></td></tr></table></figure></p>
<p>相应的，time类中就有上述五个变量来存储应该的值：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.time(12,20,59,899)</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.time(12, 20, 59, 899)</span><br><span class="line">&gt;&gt;&gt; a.hour</span><br><span class="line">12</span><br><span class="line">&gt;&gt;&gt; a.minute</span><br><span class="line">20</span><br><span class="line">&gt;&gt;&gt; a.second</span><br><span class="line">59</span><br><span class="line">&gt;&gt;&gt; a.microsecond</span><br><span class="line">899</span><br><span class="line">&gt;&gt;&gt; a.tzinfo</span><br></pre></td></tr></table></figure></p>
<p>与date类一样，time类也包含<strong>getattribute</strong>(…)方法可以读取相关属性：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;hour&apos;)</span><br><span class="line">12</span><br><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;minute&apos;)</span><br><span class="line">20</span><br><span class="line">&gt;&gt;&gt; a.__getattribute__(&apos;second&apos;)</span><br><span class="line">59</span><br></pre></td></tr></table></figure></p>
<h2 id="time类中的方法和属性"><a href="#time类中的方法和属性" class="headerlink" title="time类中的方法和属性"></a>time类中的方法和属性</h2><ul>
<li><p>比较时间大小<br>相关方法包括：<code>__eq__(...)</code>, <code>__ge__(...)</code>, <code>__gt__(...)</code>, <code>__le__(...)</code>, <code>__lt__(...)</code>， <code>__ne__(...)</code><br>这里的方法与date类中定义的方法大同小异，使用方法与一样，这里就不过多介绍了，示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.time(12,20,59,899)</span><br><span class="line">&gt;&gt;&gt; b = datetime.time(11,20,59,889)</span><br><span class="line">&gt;&gt;&gt; a.__eq__(b)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; a.__ne__(b)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; a.__ge__(b)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; a.__gt__(b)</span><br><span class="line">True</span><br><span class="line">&gt;&gt;&gt; a.__le__(b)</span><br><span class="line">False</span><br><span class="line">&gt;&gt;&gt; a.__lt__(b)</span><br><span class="line">False</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>__nonzero__(...)</code><br>判断时间对象是否非零，返回值为True/False:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.time(12,20,59,899)</span><br><span class="line">&gt;&gt;&gt; a.__nonzero__()</span><br><span class="line">True</span><br></pre></td></tr></table></figure>
</li>
<li><p>其他属性</p>
<ul>
<li><p>max：最大的时间表示数值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.time.max</span><br><span class="line">datetime.time(23, 59, 59, 999999)</span><br></pre></td></tr></table></figure>
</li>
<li><p>min：最小的时间表示数值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.time.min</span><br><span class="line">datetime.time(0, 0)</span><br></pre></td></tr></table></figure>
</li>
<li><p>resolution：时间间隔单位为分钟</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.time.resolution</span><br><span class="line">datetime.timedelta(0, 0, 1)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="时间的字符串输出"><a href="#时间的字符串输出" class="headerlink" title="时间的字符串输出"></a>时间的字符串输出</h2><ul>
<li><p>如果你想将时间对象转化为字符串对象的话，可以用到<code>__format__(...)</code>方法以指定格式进行时间输出：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = datetime.time(12,20,59,899)</span><br><span class="line">a.`__format__`(&apos;%H:%M:%S&apos;)</span><br><span class="line">&apos;12:20:59&apos;</span><br></pre></td></tr></table></figure>
<p>  与此方法等价的方法为<code>strftime(...)</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = datetime.time(12,20,59,899)</span><br><span class="line">a.strftime(&apos;%H:%M:%S&apos;)</span><br><span class="line">&apos;12:20:59&apos;</span><br></pre></td></tr></table></figure>
<p>  关于格式化字符串的相关内容，请查阅本文最后的：附录：python中时间日期格式化符号 </p>
</li>
<li><p>ISO标准输出<br>  如果要使输出的时间字符符合ISO标准，请使用isoformat(…):</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = datetime.time(12,20,59,899)</span><br><span class="line">a.isoformat()</span><br><span class="line">&apos;12:20:59.000899&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>如果只是相简单的获得时间的字符串，则使用<code>__str__(...)</code></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = datetime.time(12,20,59,899)</span><br><span class="line">a.__str__()</span><br><span class="line">&apos;12:20:59.000899&apos;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="datetime类"><a href="#datetime类" class="headerlink" title="datetime类"></a>datetime类</h1><h2 id="datetime类的数据构成"><a href="#datetime类的数据构成" class="headerlink" title="datetime类的数据构成"></a>datetime类的数据构成</h2><p>datetime类其实是可以看做是date类和time类的合体，其大部分的方法和属性都继承于这二个类，相关的操作方法请参阅，本文上面关于二个类的介绍。其数据构成也是由这二个类所有的属性所组成的。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">datetime(year, month, day[, hour[, minute[, second[, microsecond[,tzinfo]]]]])</span><br></pre></td></tr></table></figure></p>
<h2 id="专属于datetime的方法和属性"><a href="#专属于datetime的方法和属性" class="headerlink" title="专属于datetime的方法和属性"></a>专属于datetime的方法和属性</h2><ul>
<li><p><code>date(…)</code>：返回datetime对象的日期部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33, 494248)</span><br><span class="line">&gt;&gt;&gt; a.date()</span><br><span class="line">datetime.date(2017, 3, 22)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>time(…)</code>：返回datetime对象的时间部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33, 494248)</span><br><span class="line">&gt;&gt;&gt; a.time()</span><br><span class="line">datetime.time(16, 9, 33, 494248)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>utctimetuple(…)</code>：返回UTC时间元组：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33, 494248)</span><br><span class="line">&gt;&gt;&gt; a.utctimetuple()</span><br><span class="line">time.struct_time(tm_year=2017, tm_mon=3, tm_mday=22, tm_hour=16, tm_min=9, tm_sec=33, tm_wday=2, tm_yday=81, tm_isdst=0)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>combine(…)</code>：将一个date对象和一个time对象合并生成一个datetime对象：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33, 494248)</span><br><span class="line">&gt;&gt;&gt;datetime.datetime.combine(a.date(),a.time())</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33, 494248)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>now(…)</code>：返回当前日期时间的datetime对象：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 9, 33,</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>utcnow(…)</code>:返回当前日期时间的UTC datetime对象：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a = datetime.datetime.utcnow()</span><br><span class="line">&gt;&gt;&gt; a</span><br><span class="line">datetime.datetime(2017, 3, 22, 8, 26, 54, 935242)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>strptime(…)</code>：根据string, format 2个参数，返回一个对应的datetime对象：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.datetime.strptime(&apos;2017-3-22 15:25&apos;,&apos;%Y-%m-%d %H:%M&apos;)</span><br><span class="line">datetime.datetime(2017, 3, 22, 15, 25)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>utcfromtimestamp(…)</code>:UTC时间戳的datetime对象，时间戳值为<code>time.time()</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; datetime.datetime.utcfromtimestamp(time.time())</span><br><span class="line">datetime.datetime(2017, 3, 22, 8, 29, 7, 654272)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="timedelta类"><a href="#timedelta类" class="headerlink" title="timedelta类"></a>timedelta类</h1><p>timedelta类是用来计算二个datetime对象的差值的。<br>此类中包含如下属性：<br>1、days:天数<br>2、microseconds：微秒数(&gt;=0 并且 &lt;1秒）<br>3、seconds：秒数(&gt;=0 并且 &lt;1天）</p>
<h1 id="日期计算实操"><a href="#日期计算实操" class="headerlink" title="日期计算实操"></a>日期计算实操</h1><ul>
<li><p>获取当前日期时间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; now = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; now</span><br><span class="line">datetime.datetime(2017, 3, 22, 16, 55, 49, 148233)</span><br><span class="line">&gt;&gt;&gt; today = datetime.date.today()</span><br><span class="line">&gt;&gt;&gt; today</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; now.date()</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; now.time()</span><br><span class="line">datetime.time(16, 55, 49, 148233)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取上个月第一天和最后一天的日期：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; today = datetime.date.today()</span><br><span class="line">&gt;&gt;&gt; today</span><br><span class="line">datetime.date(2017, 3, 22)</span><br><span class="line">&gt;&gt;&gt; mlast_day = datetime.date(today.year, today.month, 1) - datetime.timedelta(1)</span><br><span class="line">&gt;&gt;&gt; mlast_day</span><br><span class="line">datetime.date(2017, 2, 28)</span><br><span class="line">&gt;&gt;&gt; mfirst_day = datetime.date(mlast_day.year, mlast_day.month, 1)</span><br><span class="line">&gt;&gt;&gt; mfirst_day</span><br><span class="line">datetime.date(2017, 2, 1)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取时间差<br>时间差单位为秒</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; start_time = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; end_time = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; (end_time - start_time).seconds</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>差值不只是可以查看相差多少秒，还可以查看天(days), 秒(seconds), 微秒(microseconds).</p>
<ul>
<li>计算当前时间向后8个小时的时间<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d1 = datetime.datetime.now()</span><br><span class="line">&gt;&gt;&gt; d2 = d1 + datetime.timedelta(hours = 8)</span><br><span class="line">&gt;&gt;&gt; d2</span><br><span class="line">datetime.datetime(2017, 3, 23, 1, 10, 37, 182240)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>可以计算: 天(days), 小时(hours), 分钟(minutes), 秒(seconds), 微秒(microseconds).</p>
<ul>
<li><p>计算上周一和周日的日期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">today = datetime.date.today()</span><br><span class="line">&gt;&gt;&gt; today</span><br><span class="line">datetime.date(2017, 3, 23)</span><br><span class="line">&gt;&gt;&gt; today_weekday = today.isoweekday()</span><br><span class="line">&gt;&gt;&gt; last_sunday = today - datetime.timedelta(days=today_weekday)</span><br><span class="line">&gt;&gt;&gt; last_monday = last_sunday - datetime.timedelta(days=6)</span><br><span class="line">&gt;&gt;&gt; last_sunday</span><br><span class="line">datetime.date(2017, 3, 19)</span><br><span class="line">&gt;&gt;&gt; last_monday</span><br><span class="line">datetime.date(2017, 3, 13)</span><br></pre></td></tr></table></figure>
</li>
<li><p>计算指定日期当月最后一天的日期和本月天数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; date = datetime.date(2017,12,20)</span><br><span class="line">&gt;&gt;&gt; def eomonth(date_object):</span><br><span class="line">...     if date_object.month == 12:</span><br><span class="line">...         next_month_first_date = datetime.date(date_object.year+1,1,1)</span><br><span class="line">...     else:</span><br><span class="line">...         next_month_first_date = datetime.date(date_object.year, date_object.month+1, 1)</span><br><span class="line">...     return next_month_first_date - datetime.timedelta(1)</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; eomonth(date)</span><br><span class="line">datetime.date(2017, 12, 31)</span><br><span class="line">&gt;&gt;&gt; eomonth(date).day</span><br></pre></td></tr></table></figure>
</li>
<li><p>计算指定日期下个月当天的日期<br>这里要调用上一项中的函数<code>eomonth(...)</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; date = datetime.date(2017,12,20)                                            </span><br><span class="line">&gt;&gt;&gt; def edate(date_object):                                                     </span><br><span class="line">...     if date_object.month == 12:                          </span><br><span class="line">...         next_month_date = datetime.date(date_object.year+1, 1,date_object.day)</span><br><span class="line">...     else:</span><br><span class="line">...         next_month_first_day = datetime.date(date_object.year,date_object.month+1,1)</span><br><span class="line">...         if date_object.day &gt; eomonth(last_month_first_day).day:</span><br><span class="line">...             next_month_date = datetime.date(date_object.year,date_object.month+1,eomonth(last_month_first_day).day)</span><br><span class="line">...         else:</span><br><span class="line">...             next_month_date = datetime.date(date_object.year, date_object.month+1, date_object.day)</span><br><span class="line">...     return next_month_date</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt; edate(date)</span><br><span class="line">datetime.date(2018, 1, 20)</span><br></pre></td></tr></table></figure>
</li>
<li><p>获得本周一至今天的时间段并获得上周对应同一时间段</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; today = datetime.date.today()</span><br><span class="line">&gt;&gt;&gt; this_monday = today - datetime.timedelta(today.isoweekday()-1)</span><br><span class="line">&gt;&gt;&gt; last_monday = this_monday - datetime.timedelta(7)</span><br><span class="line">&gt;&gt;&gt; last_weekday = today -datetime.timedelta(7)</span><br><span class="line">&gt;&gt;&gt; this_monday</span><br><span class="line">datetime.date(2017, 3, 20)</span><br><span class="line">&gt;&gt;&gt; today</span><br><span class="line">datetime.date(2017, 3, 23)</span><br><span class="line">&gt;&gt;&gt; last_monday</span><br><span class="line">datetime.date(2017, 3, 13)</span><br><span class="line">&gt;&gt;&gt; last_weekday</span><br><span class="line">datetime.date(2017, 3, 16)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="附录：python中时间日期格式化符号："><a href="#附录：python中时间日期格式化符号：" class="headerlink" title="附录：python中时间日期格式化符号："></a>附录：python中时间日期格式化符号：</h1><table>
<thead>
<tr>
<th>符号</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>%y</td>
<td>两位数的年份表示（00-99）</td>
</tr>
<tr>
<td>%Y</td>
<td>四位数的年份表示（000-9999）</td>
</tr>
<tr>
<td>%m</td>
<td>月份（01-12）</td>
</tr>
<tr>
<td>%d</td>
<td>月内中的一天（0-31）</td>
</tr>
<tr>
<td>%H</td>
<td>24小时制小时数（0-23）</td>
</tr>
<tr>
<td>%I</td>
<td>12小时制小时数（01-12）</td>
</tr>
<tr>
<td>%M</td>
<td>分钟数（00=59）</td>
</tr>
<tr>
<td>%S</td>
<td>秒（00-59）</td>
</tr>
<tr>
<td>%a</td>
<td>本地简化星期名称</td>
</tr>
<tr>
<td>%A</td>
<td>本地完整星期名称</td>
</tr>
<tr>
<td>%b</td>
<td>本地简化的月份名称</td>
</tr>
<tr>
<td>%B</td>
<td>本地完整的月份名称</td>
</tr>
<tr>
<td>%c</td>
<td>本地相应的日期表示和时间表示</td>
</tr>
<tr>
<td>%j</td>
<td>年内的一天（001-366）</td>
</tr>
<tr>
<td>%p</td>
<td>本地A.M.或P.M.的等价符</td>
</tr>
<tr>
<td>%U</td>
<td>一年中的星期数（00-53）星期天为星期的开始</td>
</tr>
<tr>
<td>%w</td>
<td>星期（0-6），星期天为星期的开始</td>
</tr>
<tr>
<td>%W</td>
<td>一年中的星期数（00-53）星期一为星期的开始</td>
</tr>
<tr>
<td>%x</td>
<td>本地相应的日期表示</td>
</tr>
<tr>
<td>%X</td>
<td>本地相应的时间表示</td>
</tr>
<tr>
<td>%Z</td>
<td>当前时区的名称</td>
</tr>
<tr>
<td>%%</td>
<td>%号本身</td>
</tr>
</tbody>
</table>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2019/05/17/Python-datetime模块介绍及示例/" data-id="cm50h3rb2006syfht2lknu0bc" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2019/05/17/Python-datetime模块介绍及示例/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python-calendar" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/15/python-calendar/" class="article-date">
  <time datetime="2019-04-15T08:47:57.000Z" itemprop="datePublished">2019-04-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/15/python-calendar/">python calendar</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Calendar"><a href="#Calendar" class="headerlink" title="Calendar"></a>Calendar</h1><ul>
<li><p>setfirstweekday(firstweekday)  指定一周的第一天,0是星期一,… 6为星期日</p>
</li>
<li><p>firstweekday()：返回一周的第一天，0是星期一，…，6为星期日</p>
</li>
<li><p>isleap(year)：判断指定是否是闰年，闰年为True，平年为False</p>
</li>
<li><p>leapdays(y1, y2)：返回y1与y2年份之间的闰年数量，y1与y2皆为年份。包括起始年，不包括结束年</p>
</li>
<li><p>weekday(year, month, day)：获取指定日期为星期几</p>
</li>
<li><p>weekheader(n)：返回包含星期的英文缩写，n表示英文缩写所占的宽度</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line">print(calendar.weekheader(4))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; Mon  Tue  Wed  Thu  Fri  Sat  Sun</span><br></pre></td></tr></table></figure>
</li>
<li><p>monthrange(year, month)：返回一个由一个月第一个天的星期与当前月的天数组成的元组</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line">print(2018, 8) </span><br><span class="line">    </span><br><span class="line">&gt;&gt;&gt; (2, 31)</span><br></pre></td></tr></table></figure>
</li>
<li><p>monthcalendar(year, month)：返回一个月中天数列表(不是当前月份的天数为0)，按周划分，为一个二维数组。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line"></span><br><span class="line">calendar.setfirstweekday(firstweekday=6)</span><br><span class="line">print(calendar.monthcalendar(2018, 8))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[[0, 0, 0, 1, 2, 3, 4], [5, 6, 7, 8, 9, 10, 11], [12, 13, 14, 15, 16, 17, 18], [19, 20, 21, 22, 23, 24, 25], [26, 27, 28, 29, 30, 31, 0]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>prmonth(theyear, themonth, w=0, l=0)：打印一个月的日历，theyear指定年份，themonth指定月份，w每个单元格宽度，默认0，内部已做处理，最小宽度为2，l每列换l行，默认为0，内部已做处理，至少换行1行</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line"></span><br><span class="line">calendar.setfirstweekday(firstweekday=6)</span><br><span class="line">calendar.prmonth(2018, 8)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;    August 2018</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">        1  2  3  4</span><br><span class="line">5  6  7  8  9 10 11</span><br><span class="line">12 13 14 15 16 17 18</span><br><span class="line">19 20 21 22 23 24 25</span><br><span class="line">26 27 28 29 30 31</span><br></pre></td></tr></table></figure>
</li>
<li><p>month(theyear, themonth, w=0, l=0)：返回一个月的日历的多行文本字符串。theyear指定年份，themonth指定月份，w每个单元格宽度，默认0，内部已做处理，最小宽度为2，l每列换l行，默认为0，内部已做处理，至少换行1行</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line"></span><br><span class="line">calendar.setfirstweekday(firstweekday=6)</span><br><span class="line">print(calendar.month(2018, 8))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;    August 2018</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">        1  2  3  4</span><br><span class="line">5  6  7  8  9 10 11</span><br><span class="line">12 13 14 15 16 17 18</span><br><span class="line">19 20 21 22 23 24 25</span><br><span class="line">26 27 28 29 30 31</span><br></pre></td></tr></table></figure>
</li>
<li><p>prcal(year, w=0, l=0, c=6, m=3)：打印一年的日历，w每个单元格宽度，默认0，内部已做处理，最小宽度为2，l每列换l行，默认为0，内部已做处理，至少换行1行，c表示月与月之间的间隔宽度，默认为6，内部已做处理，最小宽度为2，m表示将12个月分为m列</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line"></span><br><span class="line">calendar.setfirstweekday(firstweekday=6)</span><br><span class="line">calendar.prcal(2018, m=4)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;                                            2018</span><br><span class="line"></span><br><span class="line">    January                   February                   March                     April</span><br><span class="line">Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa</span><br><span class="line">    1  2  3  4  5  6                   1  2  3                   1  2  3       1  2  3  4  5  6  7</span><br><span class="line">7  8  9 10 11 12 13       4  5  6  7  8  9 10       4  5  6  7  8  9 10       8  9 10 11 12 13 14</span><br><span class="line">14 15 16 17 18 19 20      11 12 13 14 15 16 17      11 12 13 14 15 16 17      15 16 17 18 19 20 21</span><br><span class="line">21 22 23 24 25 26 27      18 19 20 21 22 23 24      18 19 20 21 22 23 24      22 23 24 25 26 27 28</span><br><span class="line">28 29 30 31               25 26 27 28               25 26 27 28 29 30 31      29 30</span><br><span class="line"></span><br><span class="line">......</span><br></pre></td></tr></table></figure>
</li>
<li><p>calendar(year, w=2, l=1, c=6, m=3)：以多行字符串形式返回一年的日历，w每个单元格宽度，默认2，内部已做处理，最小宽度为2，l每列换l行，默认为1，内部已做处理，至少换行1行，c表示月与月之间的间隔宽度，默认为6，内部已做处理，最小宽度为2，m表示将12个月分为m列</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import calendar</span><br><span class="line"></span><br><span class="line">calendar.setfirstweekday(firstweekday=6)</span><br><span class="line">print(calendar.calendar(2018, m=4))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;                                               2018</span><br><span class="line"></span><br><span class="line">    January                   February                   March                     April</span><br><span class="line">Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa</span><br><span class="line">    1  2  3  4  5  6                   1  2  3                   1  2  3       1  2  3  4  5  6  7</span><br><span class="line">7  8  9 10 11 12 13       4  5  6  7  8  9 10       4  5  6  7  8  9 10       8  9 10 11 12 13 14</span><br><span class="line">14 15 16 17 18 19 20      11 12 13 14 15 16 17      11 12 13 14 15 16 17      15 16 17 18 19 20 21</span><br><span class="line">21 22 23 24 25 26 27      18 19 20 21 22 23 24      18 19 20 21 22 23 24      22 23 24 25 26 27 28</span><br><span class="line">28 29 30 31               25 26 27 28               25 26 27 28 29 30 31      29 30</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="calendar-Calendar-firstweekday-0-类"><a href="#calendar-Calendar-firstweekday-0-类" class="headerlink" title="calendar.Calendar(firstweekday=0)类"></a>calendar.Calendar(firstweekday=0)类</h1><p>firstweekday为一个整数，指定一周的第一天，0是星期一(默认)，6为星期日</p>
<ul>
<li><p>iterweekdays()：获取一周的数字的迭代器，迭代器的第一个值与firstweekday的值相同</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar()</span><br><span class="line">print(list(c.iterweekdays()))</span><br><span class="line">&gt;&gt;&gt;[0, 1, 2, 3, 4, 5, 6]   # 代表星期一至星期日，0为星期一，即一周的第一天</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">print(list(c.iterweekdays()))       </span><br><span class="line">&gt;&gt;&gt;[6, 0, 1, 2, 3, 4, 5]    # 代表星期日至星期六，6为星期日，即一周的第一天</span><br></pre></td></tr></table></figure>
</li>
<li><p>itermonthdates(year, month)：获取一个月日期的迭代器，此迭代器会返回指定月份的所有日期，包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.itermonthdates(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;2018-07-29</span><br><span class="line">2018-07-30</span><br><span class="line">2018-07-31</span><br><span class="line">2018-08-01</span><br><span class="line">...</span><br><span class="line">2018-08-31</span><br><span class="line">2018-09-01</span><br></pre></td></tr></table></figure>
<p>  备注:</p>
<pre><code>1. 这里的日期为datatime.date类型
2. 请将星期天设置为一周的第一天，否则将无法直观显示其作用
</code></pre></li>
<li><p>itermonthdays(year, month)：返回一个月天数的迭代器(不是当前月份的天数为0)，此迭代器将返回指定月份的日期数字，包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.itermonthdays(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;0</span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line">1</span><br><span class="line">...</span><br><span class="line">31</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
</li>
<li><p>itermonthdays2(year, month)：返回一个月天数与星期的迭代器(不是当前月份的天数为0)，此迭代器将返回指定月份的日期数字与星期几所代表的数字组成的元组，包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.itermonthdays2(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;(0, 6)</span><br><span class="line">(0, 0)</span><br><span class="line">(0, 1)</span><br><span class="line">(1, 2)</span><br><span class="line">...</span><br><span class="line">(31, 4)</span><br><span class="line">(0, 5)</span><br></pre></td></tr></table></figure>
</li>
<li><p>monthdatescalendar(year, month)：返回一个月日期列表，按周划分，为一个二维数组。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.monthdatescalendar(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[datetime.date(2018, 7, 29), datetime.date(2018, 7, 30), datetime.date(2018, 7, 31), datetime.date(2018, 8, 1), datetime.date(2018, 8, 2), datetime.date(2018, 8, 3), datetime.date(2018, 8, 4)]</span><br><span class="line">[datetime.date(2018, 8, 5), datetime.date(2018, 8, 6), datetime.date(2018, 8, 7), datetime.date(2018, 8, 8), datetime.date(2018, 8, 9), datetime.date(2018, 8, 10), datetime.date(2018, 8, 11)]</span><br><span class="line">[datetime.date(2018, 8, 12), datetime.date(2018, 8, 13), datetime.date(2018, 8, 14), datetime.date(2018, 8, 15), datetime.date(2018, 8, 16), datetime.date(2018, 8, 17), datetime.date(2018, 8, 18)]</span><br><span class="line">[datetime.date(2018, 8, 19), datetime.date(2018, 8, 20), datetime.date(2018, 8, 21), datetime.date(2018, 8, 22), datetime.date(2018, 8, 23), datetime.date(2018, 8, 24), datetime.date(2018, 8, 25)]</span><br><span class="line">[datetime.date(2018, 8, 26), datetime.date(2018, 8, 27), datetime.date(2018, 8, 28), datetime.date(2018, 8, 29), datetime.date(2018, 8, 30), datetime.date(2018, 8, 31), datetime.date(2018, 9, 1)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>monthdayscalendar(year, month)：返回一个月中天数列表(不是当前月份的天数为0)，按周划分，为一个二维数组。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.monthdayscalendar(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[0, 0, 0, 1, 2, 3, 4]</span><br><span class="line">[5, 6, 7, 8, 9, 10, 11]</span><br><span class="line">[12, 13, 14, 15, 16, 17, 18]</span><br><span class="line">[19, 20, 21, 22, 23, 24, 25]</span><br><span class="line">[26, 27, 28, 29, 30, 31, 0]</span><br></pre></td></tr></table></figure>
</li>
<li><p>monthdays2calendar(year, month)：返回一个月中天数与星期的列表(不是当前月份的天数为0)，按周划分，为一个二维数组。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.monthdays2calendar(2018, 8):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[(0, 6), (0, 0), (0, 1), (1, 2), (2, 3), (3, 4), (4, 5)]</span><br><span class="line">[(5, 6), (6, 0), (7, 1), (8, 2), (9, 3), (10, 4), (11, 5)]</span><br><span class="line">[(12, 6), (13, 0), (14, 1), (15, 2), (16, 3), (17, 4), (18, 5)]</span><br><span class="line">[(19, 6), (20, 0), (21, 1), (22, 2), (23, 3), (24, 4), (25, 5)]</span><br><span class="line">[(26, 6), (27, 0), (28, 1), (29, 2), (30, 3), (31, 4), (0, 5)]</span><br></pre></td></tr></table></figure>
</li>
<li><p>yeardatescalendar(year, width=3)：返回一年中所有的日期，为一个4维数组。width表示将一年中12个月份进行划分，每width个月为一份，每一份包含各个月份，每个月份包含周，每周包含日期信息。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.yeardatescalendar(2018, 3):</span><br><span class="line">    print(item)</span><br><span class="line">&gt;&gt;&gt;[[[datetime.date(2017, 12, 31), datetime.date(2018, 1, 1), datetime.date(2018, 1, 2),...]]]</span><br><span class="line">[[[datetime.date(2018, 4, 1), datetime.date(2018, 4, 2), datetime.date(2018, 4, 3),...]]]</span><br><span class="line">[[[datetime.date(2018, 7, 1), datetime.date(2018, 7, 2), datetime.date(2018, 7, 3),...]]]</span><br><span class="line">[[[datetime.date(2018, 9, 30), datetime.date(2018, 10, 1), datetime.date(2018, 10, 2),...]]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>yeardayscalendar(year, width=3)：返回一年中每个月的天数，为一个4维数组。width表示将一年中12个月份进行划分，每width个月为一份；每一份包含各个月份，每个月份包含周，每周包含天数信息(不是当前月份的天数为0)。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.yeardayscalendar(2018, 3):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[[[0, 1, 2, 3, 4, 5, 6], [7, 8, 9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20], ...]]]</span><br><span class="line">[[[1, 2, 3, 4, 5, 6, 7], [8, 9, 10, 11, 12, 13, 14], [15, 16, 17, 18, 19, 20, 21], ...]]]</span><br><span class="line">[[[1, 2, 3, 4, 5, 6, 7], [8, 9, 10, 11, 12, 13, 14], [15, 16, 17, 18, 19, 20, 21], ...]]]</span><br><span class="line">[[[0, 1, 2, 3, 4, 5, 6], [7, 8, 9, 10, 11, 12, 13], [14, 15, 16, 17, 18, 19, 20], ...]]]</span><br></pre></td></tr></table></figure>
</li>
<li><p>yeardays2calendar(year, width=3)：返回一年中农每个月的天数与星期的元组，为一个4维的元组列表。width表示将一年中12个月份进行划分，每width个月为一份；每一份包含各个月份，每个月份包含周，每周包含天数与星期的元组信息(不是当前月份的天数为0)。包括月份开始那周的所有日期和月份结束那周的所有日期</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from calendar import Calendar</span><br><span class="line"></span><br><span class="line">c = Calendar(firstweekday=6)</span><br><span class="line">for item in c.yeardays2calendar(2018, 3):</span><br><span class="line">    print(item)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;[[[(0, 6), (1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5)], [(7, 6), (8, 0), ...]]]</span><br><span class="line">[[[(1, 6), (2, 0), (3, 1), (4, 2), (5, 3), (6, 4), (7, 5)], [(8, 6), (9, 0), ...]]]</span><br><span class="line">[[[(1, 6), (2, 0), (3, 1), (4, 2), (5, 3), (6, 4), (7, 5)], [(8, 6), (9, 0), ...]]]</span><br><span class="line">[[[(0, 6), (1, 0), (2, 1), (3, 2), (4, 3), (5, 4), (6, 5)], [(7, 6), (8, 0), ...]]]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="calendar-TextCalendar-firstweekday-0"><a href="#calendar-TextCalendar-firstweekday-0" class="headerlink" title="calendar.TextCalendar(firstweekday=0)"></a>calendar.TextCalendar(firstweekday=0)</h1><pre><code>Calendar子类，firstweekday为一个整数，指定一周的第一天，0是星期一(默认)，6为星期日
</code></pre><ul>
<li><p>formatmonth(theyear, themonth, w=0, l=0)：以多行字符串形式返回一个月的日历。theyear指定年，themonth指定月，w每个单元格宽度，默认0，内部已做处理，最小宽度为2，l每列换l行，默认为0，内部已做处理，至少换行1行</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from calendar import TextCalendar</span><br><span class="line"></span><br><span class="line">c = TextCalendar(firstweekday=6)</span><br><span class="line">print(c.formatmonth(2018, 8))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;    August 2018</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">        1  2  3  4</span><br><span class="line">5  6  7  8  9 10 11</span><br><span class="line">12 13 14 15 16 17 18</span><br><span class="line">19 20 21 22 23 24 25</span><br><span class="line">26 27 28 29 30 31</span><br></pre></td></tr></table></figure>
</li>
<li><p>prmonth(theyear, themonth, w=0, l=0)：打印formatmonth(theyear, themonth, w=0, l=0)的结果，无返回值</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from calendar import TextCalenadr</span><br><span class="line"></span><br><span class="line">c = TextCalendar(firstweekday=6)</span><br><span class="line">c.prmonth(2018, 8)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;    August 2018</span><br><span class="line">Su Mo Tu We Th Fr Sa</span><br><span class="line">        1  2  3  4</span><br><span class="line">5  6  7  8  9 10 11</span><br><span class="line">12 13 14 15 16 17 18</span><br><span class="line">19 20 21 22 23 24 25</span><br><span class="line">26 27 28 29 30 31</span><br></pre></td></tr></table></figure>
<p>  因为无返回值，所以返回的结果为None</p>
</li>
<li><p>formatyear(theyear, w=2, l=1, c=6, m=3)：以多行字符串形式返回一年的日历，w每个单元格宽度，默认0，内部已做处理，最小宽度为2，l每列换l行，默认为0，内部已做处理，至少换行1行，c月与月之间的间隔宽度，默认为6，内部已做处理，最小宽度为2，m表示将12个月分为m列</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from calendar import TextCalendar</span><br><span class="line"></span><br><span class="line">c = TextCalendar(firstweekday=6)</span><br><span class="line">print(c.format(2018, m=4))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;                                       2018</span><br><span class="line"></span><br><span class="line">    January                   February                   March                     April</span><br><span class="line">Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa      Su Mo Tu We Th Fr Sa</span><br><span class="line">    1  2  3  4  5  6                   1  2  3                   1  2  3       1  2  3  4  5  6  7</span><br><span class="line">7  8  9 10 11 12 13       4  5  6  7  8  9 10       4  5  6  7  8  9 10       8  9 10 11 12 13 14</span><br><span class="line">14 15 16 17 18 19 20      11 12 13 14 15 16 17      11 12 13 14 15 16 17      15 16 17 18 19 20 21</span><br><span class="line">21 22 23 24 25 26 27      18 19 20 21 22 23 24      18 19 20 21 22 23 24      22 23 24 25 26 27 28</span><br><span class="line">28 29 30 31               25 26 27 28               25 26 27 28 29 30 31      29 30</span><br></pre></td></tr></table></figure>
</li>
<li><p>pryear(theyear, w=2, l=1, c=6, m=3)：将formatyear(theyear, w=2, l=1, c=6, m=3)的结果作为返回</p>
</li>
</ul>
<h1 id="calendar-HTMLCalendar-firstweekday-0"><a href="#calendar-HTMLCalendar-firstweekday-0" class="headerlink" title="calendar.HTMLCalendar(firstweekday=0)"></a>calendar.HTMLCalendar(firstweekday=0)</h1><pre><code>Calendar的子类，firstweekday为一个整数，指定一周的第一天，0是星期一(默认)，6为星期日
</code></pre><ul>
<li><p>formatmonth(theyear, themonth, withyear=Ture)：返回一个月日历的html内容，withyear是否显示年份，默认为True，即显示年份</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from calendar import HTMLCalendar</span><br><span class="line"></span><br><span class="line">c = HTMLCalendar(firstweekday=6)</span><br><span class="line">print(c.formatmonth(2018, 8, withyear=False))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;&lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; class=&quot;month&quot;&gt;</span><br><span class="line">&lt;tr&gt;&lt;th colspan=&quot;7&quot; class=&quot;month&quot;&gt;August&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;th class=&quot;sun&quot;&gt;Sun&lt;/th&gt;&lt;th class=&quot;mon&quot;&gt;Mon&lt;/th&gt;&lt;th class=&quot;tue&quot;&gt;Tue&lt;/th&gt;&lt;th class=&quot;wed&quot;&gt;Wed&lt;/th&gt;&lt;th class=&quot;thu&quot;&gt;Thu&lt;/th&gt;&lt;th class=&quot;fri&quot;&gt;Fri&lt;/th&gt;&lt;th class=&quot;sat&quot;&gt;Sat&lt;/th&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;td class=&quot;noday&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;td class=&quot;noday&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;td class=&quot;noday&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;td class=&quot;wed&quot;&gt;1&lt;/td&gt;&lt;td class=&quot;thu&quot;&gt;2&lt;/td&gt;&lt;td class=&quot;fri&quot;&gt;3&lt;/td&gt;&lt;td class=&quot;sat&quot;&gt;4&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;td class=&quot;sun&quot;&gt;5&lt;/td&gt;&lt;td class=&quot;mon&quot;&gt;6&lt;/td&gt;&lt;td class=&quot;tue&quot;&gt;7&lt;/td&gt;&lt;td class=&quot;wed&quot;&gt;8&lt;/td&gt;&lt;td class=&quot;thu&quot;&gt;9&lt;/td&gt;&lt;td class=&quot;fri&quot;&gt;10&lt;/td&gt;&lt;td class=&quot;sat&quot;&gt;11&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;td class=&quot;sun&quot;&gt;12&lt;/td&gt;&lt;td class=&quot;mon&quot;&gt;13&lt;/td&gt;&lt;td class=&quot;tue&quot;&gt;14&lt;/td&gt;&lt;td class=&quot;wed&quot;&gt;15&lt;/td&gt;&lt;td class=&quot;thu&quot;&gt;16&lt;/td&gt;&lt;td class=&quot;fri&quot;&gt;17&lt;/td&gt;&lt;td class=&quot;sat&quot;&gt;18&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;td class=&quot;sun&quot;&gt;19&lt;/td&gt;&lt;td class=&quot;mon&quot;&gt;20&lt;/td&gt;&lt;td class=&quot;tue&quot;&gt;21&lt;/td&gt;&lt;td class=&quot;wed&quot;&gt;22&lt;/td&gt;&lt;td class=&quot;thu&quot;&gt;23&lt;/td&gt;&lt;td class=&quot;fri&quot;&gt;24&lt;/td&gt;&lt;td class=&quot;sat&quot;&gt;25&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">&lt;tr&gt;&lt;td class=&quot;sun&quot;&gt;26&lt;/td&gt;&lt;td class=&quot;mon&quot;&gt;27&lt;/td&gt;&lt;td class=&quot;tue&quot;&gt;28&lt;/td&gt;&lt;td class=&quot;wed&quot;&gt;29&lt;/td&gt;&lt;td class=&quot;thu&quot;&gt;30&lt;/td&gt;&lt;td class=&quot;fri&quot;&gt;31&lt;/td&gt;&lt;td class=&quot;noday&quot;&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>formatyear(theyear, width=3)：返回一年日历的html内容，width表示将12个月分为width列</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from calendar import HTMLCalendar</span><br><span class="line"></span><br><span class="line">c = HTMLCalendar(firstweekday=6)</span><br><span class="line">print(c.formatyear(2018, width=4))</span><br></pre></td></tr></table></figure>
</li>
<li><p>formatyearpage(theyear, width=3, css=’calendar.css’, encoding=None)：返回一年日历的html内容，width表示将12个月分为width列，css可自定义css样式，encoding编码方式</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">from calendar import HTMLCalendar</span><br><span class="line"></span><br><span class="line">c = HTMLCalendar(firstweekday=6)</span><br><span class="line">print(c.formatyearpage(2018, width=4))</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2019/04/15/python-calendar/" data-id="cm50h3raz006lyfhtpvieqnk6" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2019/04/15/python-calendar/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-django2-2-build-website-and-deploy-in-ubuntu-server" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/04/09/django2-2-build-website-and-deploy-in-ubuntu-server/" class="article-date">
  <time datetime="2019-04-09T02:26:58.000Z" itemprop="datePublished">2019-04-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/04/09/django2-2-build-website-and-deploy-in-ubuntu-server/">django2.2 build website and deploy in ubuntu server</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Crete-virtualenv"><a href="#Crete-virtualenv" class="headerlink" title="Crete virtualenv"></a>Crete virtualenv</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">pip install pipenv</span><br><span class="line"></span><br><span class="line">mkdir website</span><br><span class="line"></span><br><span class="line">cd website</span><br><span class="line"></span><br><span class="line">pipenv shell --python 3.6</span><br><span class="line"></span><br><span class="line">pipenv install django</span><br><span class="line"></span><br><span class="line">pipenv install pymysql</span><br><span class="line"></span><br><span class="line">pipenv install gunicorn</span><br></pre></td></tr></table></figure>
<p>when running django have some errors. so we have to change django code.</p>
<ul>
<li>one<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /home/tonytan/.local/share/virtualenvs/website-skIUga7b/lib/python3.7/site-packages/django/db/backends/mysql/base.py</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>change to notes line 35, 36,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#if version &lt; (1, 3, 13):</span><br><span class="line">#    raise ImproperlyConfigured(&apos;mysqlclient 1.3.13 or newer is required; you have %s.&apos; % Database.__version__)</span><br></pre></td></tr></table></figure>
<ul>
<li>two</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /home/tonytan/.local/share/virtualenvs/website-skIUga7b/lib/python3.7/site-packages/django/db/backends/mysql/operations.py</span><br></pre></td></tr></table></figure>
<p>in line 146</p>
<p>change:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query = query.decode(errors=&apos;replace&apos;)</span><br></pre></td></tr></table></figure></p>
<p>to<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">query = query.decode(errors=&apos;replace&apos;) if not isinstance(query, str) else query</span><br></pre></td></tr></table></figure></p>
<h1 id="Create-project"><a href="#Create-project" class="headerlink" title="Create project"></a>Create project</h1><ul>
<li>create project &amp; app</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">django-admin.py startproject website</span><br><span class="line">cd website</span><br></pre></td></tr></table></figure>
<ul>
<li>change mysql package<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim website/__init__.py</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>the path is <code>/website/website/website/__init__.py</code></p>
<p>add:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import pymysql</span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure></p>
<ul>
<li>sql migrate</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migreate</span><br></pre></td></tr></table></figure>
<ul>
<li>running test server</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>
<ul>
<li>flush sql data</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py flush</span><br></pre></td></tr></table></figure>
<ul>
<li>create super user</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py createsuperuser</span><br></pre></td></tr></table></figure>
<ul>
<li>import &amp; output data</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python manage.py dumpdata appname &gt; appname.json</span><br><span class="line">python manage.py loaddata appname.json</span><br></pre></td></tr></table></figure>
<ul>
<li>create app</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py startapp users</span><br></pre></td></tr></table></figure>
<p>add app to settings</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim website/settings.py</span><br></pre></td></tr></table></figure>
<p>in <code>INSTALLED_APPS</code> add <code>&quot;user&quot;,</code></p>
<p>now you can coding some app in django…</p>
<h1 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install nginx</span><br><span class="line">sudo pip install supervisor</span><br></pre></td></tr></table></figure>
<p>set this web nginx config<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/nginx/conf/website.conf</span><br></pre></td></tr></table></figure></p>
<p>add the following code to <code>website.conf</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        server_name www.xxxx.com;</span><br><span class="line">        server_name 100.000.000.000;</span><br><span class="line">        charset     utf-8;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">                try_files $uri $uri/ =404;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /media  &#123;</span><br><span class="line">                alias /path/to/your/static/media;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        location /static/ &#123;</span><br><span class="line">                root /path/to/your/static/main/folder/;   </span><br><span class="line">                #Note: this is static main folder not static folder</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"># this is for api</span><br><span class="line">        location /apis &#123;</span><br><span class="line">                rewrite ^.+apis/?(.*)$ /$1 break;</span><br><span class="line">                proxy_pass http://127.0.0.1:8000;</span><br><span class="line">                proxy_pass_header       Authorization;</span><br><span class="line">                proxy_pass_header       WWW-Authenticate;</span><br><span class="line">                proxy_set_header Host $host;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"># this is for django admin</span><br><span class="line">        location /admin &#123;</span><br><span class="line">                proxy_pass http://127.0.0.1:8000;</span><br><span class="line">                proxy_set_header Host $host;</span><br><span class="line">                proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line">                proxy_set_header X-Forwarded-Proto $scheme;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>set this web supervisor config<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/supervisor/conf/website.conf</span><br></pre></td></tr></table></figure></p>
<p>add the folloing code to ‘website.conf’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[program: website]</span><br><span class="line">command = /home/tony/.local/share/virtualenvs/website-skIUga7b/bin/gunicorn -w 4 -b 0.0.0.0:8000 website.wsgi:application</span><br><span class="line">directory = /data/website/website</span><br><span class="line">user = root</span><br><span class="line">stdout_logfile = /var/log/supervisor/stdout.log</span><br><span class="line">stderr_logfile = /var/log/supervisor/stderr.log</span><br></pre></td></tr></table></figure></p>
<p>reload nginx &amp; supervisor<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/ngins reload</span><br><span class="line">sudo nginx -t</span><br><span class="line"></span><br><span class="line">sudo /etc/init.d/supervisor reload</span><br><span class="line">sudo /etc/init.d/supervisor restart</span><br><span class="line">sudo /etc/init.d/supervisor status</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2019/04/09/django2-2-build-website-and-deploy-in-ubuntu-server/" data-id="cm50h3rax006hyfhtofx1eoz1" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2019/04/09/django2-2-build-website-and-deploy-in-ubuntu-server/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/django/">django</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Python-group-function-groupby-itertools" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/22/Python-group-function-groupby-itertools/" class="article-date">
  <time datetime="2018-11-22T02:06:53.000Z" itemprop="datePublished">2018-11-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/22/Python-group-function-groupby-itertools/">Python group function (groupby, itertools)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>If the strucutre of data is:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">d1=&#123;&apos;name&apos;:&apos;zhangsan&apos;,&apos;age&apos;:20,&apos;country&apos;:&apos;China&apos;&#125;</span><br><span class="line">d2=&#123;&apos;name&apos;:&apos;wangwu&apos;,&apos;age&apos;:19,&apos;country&apos;:&apos;USA&apos;&#125;</span><br><span class="line">d3=&#123;&apos;name&apos;:&apos;lisi&apos;,&apos;age&apos;:22,&apos;country&apos;:&apos;JP&apos;&#125;</span><br><span class="line">d4=&#123;&apos;name&apos;:&apos;zhaoliu&apos;,&apos;age&apos;:22,&apos;country&apos;:&apos;USA&apos;&#125;</span><br><span class="line">d5=&#123;&apos;name&apos;:&apos;pengqi&apos;,&apos;age&apos;:22,&apos;country&apos;:&apos;USA&apos;&#125;</span><br><span class="line">d6=&#123;&apos;name&apos;:&apos;lijiu&apos;,&apos;age&apos;:22,&apos;country&apos;:&apos;China&apos;&#125;</span><br><span class="line">lst = [d1, d2, d3, d4, d5, d6]</span><br></pre></td></tr></table></figure></p>
<p>how to group by <code>country</code> item and get the result:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;JP&apos;: [&#123;&apos;country&apos;: &apos;JP&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lisi&apos;&#125;], &apos;China&apos;: [&#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 20, &apos;name&apos;: &apos;zhangsan&apos;&#125;, &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lijiu&apos;&#125;], &apos;USA&apos;: [&#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 19, &apos;name&apos;: &apos;wangwu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;zhaoliu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;pengqi&apos;&#125;]&#125;</span><br></pre></td></tr></table></figure></p>
<p> or<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(&apos;China&apos;, [&#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 20, &apos;name&apos;: &apos;zhangsan&apos;&#125;, &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lijiu&apos;&#125;]), (&apos;JP&apos;, [&#123;&apos;country&apos;: &apos;JP&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lisi&apos;&#125;]), (&apos;USA&apos;, [&#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 19, &apos;name&apos;: &apos;wangwu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;zhaoliu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;pengqi&apos;&#125;])]</span><br></pre></td></tr></table></figure></p>
<p>the coding is following:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from operator import itemgetter</span><br><span class="line">from itertools import groupby</span><br><span class="line"></span><br><span class="line">lst.sort(key=itemgetter(&apos;country&apos;))</span><br><span class="line">lstg = groupby(lst, itemgetter(&apos;country&apos;))</span><br></pre></td></tr></table></figure></p>
<p><code>itemgettet(&#39;country&#39;)</code> is same as <code>lambda x: x[&#39;country&#39;]</code></p>
<p>then we can get what we wanted.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for key, group in lstg:</span><br><span class="line">	for g in group:  # group is a iter</span><br><span class="line">		print(key, g)</span><br></pre></td></tr></table></figure>
<p>return:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">China &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 20, &apos;name&apos;: &apos;zhangsan&apos;&#125;</span><br><span class="line">China &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lijiu&apos;&#125;</span><br><span class="line">JP &#123;&apos;country&apos;: &apos;JP&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lisi&apos;&#125;</span><br><span class="line">USA &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 19, &apos;name&apos;: &apos;wangwu&apos;&#125;</span><br><span class="line">USA &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;zhaoliu&apos;&#125;</span><br><span class="line">USA &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;pengqi&apos;&#125;</span><br></pre></td></tr></table></figure></p>
<p><code>key</code> is a grouped the key.</p>
<p>Get the list which include dict the key is country:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(key, list(group)) for key, group in lstg]</span><br></pre></td></tr></table></figure></p>
<p>return:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[(&apos;China&apos;, [&#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 20, &apos;name&apos;: &apos;zhangsan&apos;&#125;, &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lijiu&apos;&#125;]), (&apos;JP&apos;, [&#123;&apos;country&apos;: &apos;JP&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lisi&apos;&#125;]), (&apos;USA&apos;, [&#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 19, &apos;name&apos;: &apos;wangwu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;zhaoliu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;pengqi&apos;&#125;])]</span><br></pre></td></tr></table></figure></p>
<p>Get the dict which key is country:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict([(key, list(group)) for key, group in lstg])</span><br></pre></td></tr></table></figure></p>
<p>return:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;JP&apos;: [&#123;&apos;country&apos;: &apos;JP&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lisi&apos;&#125;], &apos;China&apos;: [&#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 20, &apos;name&apos;: &apos;zhangsan&apos;&#125;, &#123;&apos;country&apos;: &apos;China&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;lijiu&apos;&#125;], &apos;USA&apos;: [&#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 19, &apos;name&apos;: &apos;wangwu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;zhaoliu&apos;&#125;, &#123;&apos;country&apos;: &apos;USA&apos;, &apos;age&apos;: 22, &apos;name&apos;: &apos;pengqi&apos;&#125;]&#125;</span><br></pre></td></tr></table></figure></p>
<p>Get the numbers of every group:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dict([(key, len(list(group))) for key,group in lstg])</span><br></pre></td></tr></table></figure></p>
<p>return:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&apos;JP&apos;: 1, &apos;China&apos;: 2, &apos;USA&apos;: 3&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2018/11/22/Python-group-function-groupby-itertools/" data-id="cm50h3raw006eyfhtg1t5s2k9" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2018/11/22/Python-group-function-groupby-itertools/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Flask-application-run-threads-in-the-background" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/17/Flask-application-run-threads-in-the-background/" class="article-date">
  <time datetime="2018-11-17T06:03:15.000Z" itemprop="datePublished">2018-11-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/17/Flask-application-run-threads-in-the-background/">Flask application run threads in the background</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Example is following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line">from time import sleep</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line">executor = ThreadPoolExecutor(2)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&apos;/jobs&apos;)</span><br><span class="line">def run_jobs():</span><br><span class="line">	executor.submit(some_long_task1)</span><br><span class="line">	executor.submit(some_long_task2, &apos;hello&apos;, 123)</span><br><span class="line">	return &apos;Two jobs was launched in background!&apos;</span><br><span class="line"></span><br><span class="line">def some_long_task1():</span><br><span class="line">	print(&apos;Task #1 started&apos;)</span><br><span class="line">	sleep(10)</span><br><span class="line">	print(&apos;Task #1 is done&apos;)</span><br><span class="line"></span><br><span class="line">def some_long_task2(arg1, arg2):</span><br><span class="line">	print(&apos;Task #2 started&apos;)</span><br><span class="line">	sleep(5)</span><br><span class="line">	print(&apos;Task #2 is done&apos;)</span><br><span class="line"></span><br><span class="line">if __name__==&apos;__main__&apos;:</span><br><span class="line">	app.run()</span><br></pre></td></tr></table></figure>
<p><code>concurrent.futures</code> is introduced from python3.2, and provied higher abstract than <code>threading</code> and <code>multiprocessing</code>, it’s include two class <code>ThreadPoolExecutor</code> and <code>ProcessPoolExecutor</code>.</p>
<p>for more information you can view in <a href="https://docs.python.org/3/library/concurrent.futures.html#module-concurrent.futures" target="_blank" rel="noopener">python docuemnts for concurrent.furtures</a></p>
<ol>
<li>Executor</li>
</ol>
<p>Executor is a base module, this is a abstract class, the subclass is <code>ThreadPoolExecutor</code> and <code>ProcessPoolExecutor</code> which is to be used create thred pool and process pool.</p>
<p>the methods is following:</p>
<ul>
<li><code>Executor.submit(fn, *args, **kwargs)</code></li>
</ul>
<p>example is:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with ThreadPoolExecutor(max_workers=2) as executor:</span><br><span class="line">	future = executor.submit(pow, 22, 123)</span><br><span class="line">	print(futrue.result())</span><br></pre></td></tr></table></figure></p>
<p>we use <code>submit</code> method join a <code>task</code> in tread pool, <code>submit</code> return a <code>Future</code> object. and the <code>future.result()</code> is use <code>result</code> method get the result.<br>it will wainting untill the method is finished.<br>we use <code>with</code> for auto call ‘shutdown’ method otherwise we have to wait some release code.</p>
<ul>
<li><code>Executor.map(fn, *args, **kwargs)</code></li>
</ul>
<p>the <code>map</code> method is same with python map method. but it can set out time by arguement. <code>timeout</code> is int or float. if method overtime, will <code>raise TimeoutError</code>. it will no time out if it’s not set <code>timeout</code>.</p>
<table>
<thead>
<tr>
<th>arguement</th>
<th>desc</th>
</tr>
</thead>
<tbody>
<tr>
<td>func</td>
<td>the method</td>
</tr>
<tr>
<td>iterables</td>
<td>iter object</td>
</tr>
<tr>
<td>timeout</td>
<td>timeout setting</td>
</tr>
</tbody>
</table>
<p>example is:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">form concurrent.futures import ThreadPoolExecutor</span><br><span class="line">import requests</span><br><span class="line">URLS = [&quot;http://www.163.com&quot;, &quot;https://www.baidu.com&quot;, &quot;https://github.com&quot;]</span><br><span class="line"></span><br><span class="line">def load_url(url):</span><br><span class="line">	req = requests.get(url)</span><br><span class="line">	print(f&quot;&#123;url&#125; page is &#123;len(req.content)&#125; bytes&quot;)</span><br><span class="line"></span><br><span class="line">executor = ThreadPoolExecutor(max_workers=3)</span><br><span class="line">executor.map(load_url, URLS)</span><br></pre></td></tr></table></figure></p>
<ul>
<li><code>Executor.shutdown(wait=True)</code></li>
</ul>
<p>this method is used by release system resources. <code>Executor</code> have <code>__enter__</code> and <code>__exit__</code> methods, so it can use <code>with</code>.</p>
<ol start="2">
<li>Future</li>
</ol>
<p><code>submit</code> method will return a <code>futrue</code> object. <code>future</code> have many methods for shadow task status. <code>Future</code> is created by <code>Executor.submit()</code>.</p>
<table>
<thead>
<tr>
<th>method</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>cancel()</td>
<td>cancel call, it cannot cancel if running now and return False, otherwise return True</td>
</tr>
<tr>
<td>cancelled()</td>
<td>check if is it cancel success or false and return True or False</td>
</tr>
<tr>
<td>running()</td>
<td></td>
</tr>
<tr>
<td>done()</td>
<td>check if is it call success or fail when running and return True or False</td>
</tr>
<tr>
<td>result(Timeout=None)</td>
<td>get result, if it’s not finished, it will waitting</td>
</tr>
<tr>
<td>exception(timeout=None)</td>
<td>get the except</td>
</tr>
<tr>
<td>add_done_callback(fn)</td>
<td>it will bind fn to future object.</td>
</tr>
</tbody>
</table>
<ul>
<li><code>wait</code></li>
</ul>
<p><code>wait</code> method will return a tuple, the tuple include two set, it is <code>completed</code> and <code>uncompleted</code>.<br><code>wait</code> method have 3 arguements <code>FIRST_COMPLETED</code>, <code>FIRST_EXCEPTION</code> and <code>ALL_COMPLETE</code>, the default is <code>ALL_COMPLETED</code>.</p>
<p>If use default <code>ALL_COMPLETED</code>, the program will blocked untill all tasks completed and then run main thread.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from concurrent.future import ThreadPoolExecutor, wait, as_completed</span><br><span class="line">import requests</span><br><span class="line">URLS = [&apos;http://www.163.com&apos;, &apos;http://www.baidu.com&apos;]</span><br><span class="line">def load_url(url):</span><br><span class="line">	req = requests.get(url)</span><br><span class="line">	print(f&apos;&#123;url&#125; page is &#123;len(req.content)&#125; bytes&apos;)</span><br><span class="line"></span><br><span class="line">executor = ThreadPoolExecutor(max_workers=3)</span><br><span class="line">f_list = []</span><br><span class="line">for url in URLS:</span><br><span class="line">	future = executor.submit(load_url, url)</span><br><span class="line">	f_list.append(future)</span><br><span class="line"></span><br><span class="line">print(wait(f_list))</span><br><span class="line">print(&apos;Main Thread is closed&apos;)</span><br></pre></td></tr></table></figure></p>
<p>If use <code>FIRST_COMPLETED</code>, the program will closed but not waiting all tasks finished.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from concurrent.future import ThreadPoolExecutor, wait, as_completed</span><br><span class="line">import requests</span><br><span class="line">URLS = [&apos;http://www.163.com&apos;, &apos;http://www.baidu.com&apos;]</span><br><span class="line">def load_url(url):</span><br><span class="line">	req = requests.get(url)</span><br><span class="line">	print(f&apos;&#123;url&#125; page is &#123;len(req.content)&#125; bytes&apos;)</span><br><span class="line"></span><br><span class="line">executor = ThreadPoolExecutor(max_workers=3)</span><br><span class="line">f_list = []</span><br><span class="line">for url in URLS:</span><br><span class="line">	future = executor.submit(load_url, url)</span><br><span class="line">	f_list.append(future)</span><br><span class="line"></span><br><span class="line">print(wait(f_list, return_when=&quot;FIRST_COMPLETED&quot;))</span><br><span class="line">print(&apos;Main Thread is closed&apos;)</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2018/11/17/Flask-application-run-threads-in-the-background/" data-id="cm50h3rau006ayfhtc1jcpgyt" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2018/11/17/Flask-application-run-threads-in-the-background/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/flask/">flask</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/6/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Github/">Github</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Karrigell/">Karrigell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIM/">VIM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/conda/">conda</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/django/">django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ffmpeg/">ffmpeg</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/freeswitch/">freeswitch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jekyll/">jekyll</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kivy/">kivy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/mac/">mac</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/normal/">normal</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sqlalchemy/">sqlalchemy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system/">system</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tornado/">tornado</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ubuntu/">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/conda/">conda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django-celery/">django-celery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/freeswitch/">freeswitch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/other/">other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/system/">system</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tornado/">tornado</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/conda/" style="font-size: 10px;">conda</a> <a href="/tags/django/" style="font-size: 18px;">django</a> <a href="/tags/django-celery/" style="font-size: 10px;">django-celery</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/freeswitch/" style="font-size: 10px;">freeswitch</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 14px;">go</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/linux/" style="font-size: 16px;">linux</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/other/" style="font-size: 12px;">other</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/sqlalchemy/" style="font-size: 10px;">sqlalchemy</a> <a href="/tags/system/" style="font-size: 12px;">system</a> <a href="/tags/tornado/" style="font-size: 10px;">tornado</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/23/Python-Typing类型提示/">Python Typing类型提示</a>
          </li>
        
          <li>
            <a href="/2024/12/23/Python-Tempfile临时文件系统对象/">Python Tempfile临时文件系统对象</a>
          </li>
        
          <li>
            <a href="/2024/12/23/Python-Pathlib处理文件路径库的使用/">Python Pathlib处理文件路径库的使用</a>
          </li>
        
          <li>
            <a href="/2024/08/31/在ubuntu上的18个非常实用的命令行工具软件/">在ubuntu上的18个非常实用的命令行工具软件</a>
          </li>
        
          <li>
            <a href="/2024/08/20/什么是动态规划？在Python中如何利用动态规划解决实际问题？/">什么是动态规划？在Python中如何利用动态规划解决实际问题？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Tony Tan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'TonyTan';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>