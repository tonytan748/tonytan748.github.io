<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Tony Tan</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Tony Tan">
<meta name="keywords" content="Tony Tan">
<meta property="og:type" content="website">
<meta property="og:title" content="Tony Tan">
<meta property="og:url" content="https://tonytan748.github.io/page/13/index.html">
<meta property="og:site_name" content="Tony Tan">
<meta property="og:description" content="Tony Tan">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Tony Tan">
<meta name="twitter:description" content="Tony Tan">
  
    <link rel="alternate" href="/atom.xml" title="Tony Tan" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Tony Tan</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">a python progrmmer</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://tonytan748.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-how-to-set-up-a-samba-file-server-to-use-with-windows-clients" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/12/how-to-set-up-a-samba-file-server-to-use-with-windows-clients/" class="article-date">
  <time datetime="2014-08-11T16:00:00.000Z" itemprop="datePublished">2014-08-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/12/how-to-set-up-a-samba-file-server-to-use-with-windows-clients/">How to set up a Samba file server to use with Windows clients</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>According to the Samba project web site, Samba is an open source/free software suite that provides seamless file and print services to SMB/CIFS clients.</em></p>
<p>According to the Samba project web site, Samba is an open source/free software suite that provides seamless file and print services to SMB/CIFS clients. Unlike other implementations of the SMB/CIFS networking protocol (such as LM Server for HP-UX, LAN Server for OS/2, or VisionFS), Samba (along with its source code) is freely available (at no cost to the end user), and allows for interoperability between Linux/Unix servers and Windows/Unix/Linux clients.</p>
<p>For these reasons, Samba is the preferred solution for a file server in networks where different operating systems (other than Linux) coexist - the most common setup being the case of multiple Microsoft Windows clients accessing a Linux server where Samba is installed, which is the situation we are going to deal with in this article.</p>
<p>Please note that on the other hand, if our network consists of only Unix-based clients (such as Linux, AIX, or Solaris, to name a few examples), we can consider using NFS (although Samba is still an option in this case), which has greater reported speeds.</p>
<h3>Installing Samba in Debian and CentOS</h3>

<p>Before we proceed with the installation, we can use our operating system’s package management system to look for information about Samba:</p>
<p>On Debian:</p>
<pre>
# aptitude show samba
</pre>

<p>On CentOS:</p>
<pre>
# yum info samba
</pre>

<p>In the following screenshot we can see the output of ‘aptitude show samba’ (‘yum info samba’ yields similar results):</p>
<p><img src="https://farm4.staticflickr.com/3868/14837993244_0fa525eb35_z.jpg"></p>
<p>Now let’s install Samba (the screenshot below corresponds to the installation on a Debian 7 [Wheezy] server):</p>
<p>On Debian:</p>
<pre>
# aptitude install samba
</pre>

<p>On CentOS:</p>
<pre>
# yum install samba
</pre>

<h3>Adding Users to Samba</h3>

<p>For versions earlier than 4.x, a local Unix account is required for adding users to Samba:</p>
<pre>
# adduser username
</pre>

<p><img src="https://farm6.staticflickr.com/5574/14837266181_fed68bddf2_o.png"></p>
<p>Next, we need to add the user to Samba using the smbpasswd command with the ‘-a’ option, which specifies that the username following should be added to the local smbpasswd file. We will be prompted to enter a password (which does not necessarily have to be the same as the password of the local Unix account):</p>
<pre>
# smbpassword -a username
</pre>

<p><img src="https://farm6.staticflickr.com/5555/14653711099_578f8613ca.jpg"></p>
<p>Finally, we will give access to user xmodulo to a directory within our system that will be used as a Samba share for him (and other users as well, if needed). This is done by opening the /etc/samba/smb.conf file with a text editor (such as Vim), navigating to the end of the file, and creating a section (enclose name between square brackets) with a descriptive name, such as [xmodulo]:</p>
<pre>
# SAMBA SHARE 
[xmodulo] 
path = /home/xmodulo 
available = yes 
valid users = xmodulo 
read only = no 
browseable = yes 
public = yes 
writeable = yes
</pre>

<p>We must now restart Samba and -just in case- check the smb.conf file for syntax errors with the testparm command:</p>
<pre>
# service samba restart 
# testparm
</pre>

<p><img src="https://farm6.staticflickr.com/5589/14653655390_becb4f4981_z.jpg"></p>
<p>If there are any errors, they will be reported when testparm ends.</p>
<h3>Mapping the Samba Share as a Network Drive on a Windows 7 PC</h3>

<p>Right click on Computer, and select “Map network drive”:</p>
<p><img src="https://farm6.staticflickr.com/5571/14837993154_981b73ea92.jpg"></p>
<p>Type the IP address of the machine where Samba is installed, followed by the name of the share (this is the name that is enclosed between single brackets in the smb.conf file), and make sure that the “Connect using different credentials” checkbox is checked:</p>
<p><img src="https://farm4.staticflickr.com/3881/14839997172_d67ec98933_o.png"></p>
<p>Enter the username and password that were set with ‘smbpasswd -a’ earlier:</p>
<p><img src="https://farm6.staticflickr.com/5563/14653711029_ddfea53bd6_o.png"></p>
<p>Go to Computer and check if the network drive has been added correctly:</p>
<p><img src="https://farm6.staticflickr.com/5584/14837993124_c664728039_o.png"></p>
<p>As a test, let’s create a pdf file from the man page of Samba, and save it in the /home/xmodulo directory:</p>
<p><img src="https://farm6.staticflickr.com/5593/14860219723_e8380f0d0f_o.png"></p>
<p>Next, we can verify that the file is accessible from Windows:</p>
<p><img src="https://farm4.staticflickr.com/3869/14817386696_74a12dfdcd_o.png"></p>
<p>And we can open it using our default pdf reader:</p>
<p><img src="https://farm6.staticflickr.com/5584/14653655350_8a243b1493_z.jpg"></p>
<p>Finally, let’s see if we can save a file from Windows in our newly mapped network drive. We will open the change.log file that lists the features of Notepad++:</p>
<p><img src="https://farm6.staticflickr.com/5565/14817386676_18c1d7bc60_o.png"></p>
<p>and try to save it in Z:\ as a plain text file (.txt extension); then let’s see if the file is visible in Linux:</p>
<p><img src="https://farm4.staticflickr.com/3841/14817386656_fb09a95a65_o.png"></p>
<h3>Enabling quotas</h3>

<p>As a first step, we need to verify whether the current kernel has been compiled with quota support:</p>
<pre>
# cat /boot/config-$(uname -r) | grep -i config_quota
</pre>

<p><img src="https://farm4.staticflickr.com/3867/14837993054_081dc9b0dc_z.jpg"></p>
<p>Each file system has up to five types of quota limits that can be enforced on it: user soft limit, user hard limit, group soft limit, group hard limit, and grace time.</p>
<p>We will now enable quotas for the /home file system by adding the usrquota and grpquota mount options to the existing defaults option in the line that corresponds to the /home filesystem in the /etc/fstab file, and we will remount the file system in order to apply the changes:</p>
<p><img src="https://farm6.staticflickr.com/5561/14653806067_b8b0dc2333_z.jpg"></p>
<p>Next, we need to create two files that will serve as the databases for user and group quotas: <b>aquota.user</b> and <b>aquota.group</b>, respectively, in <b>/home</b>. Then, we will generate the table of current disk usage per file system with quotas enabled:</p>
<pre>
# quotacheck -cug /home 
# quotacheck -avugm
</pre>

<p><img src="https://farm6.staticflickr.com/5584/14837265971_654e8f3bc0_o.png"></p>
<p>Even though we have enabled quotas for the /home file system, we have not yet set any limits for any user or group. Check for quota information for existing user/group:</p>
<pre>
# quota -u username 
# quota -g groupname
</pre>

<p><img src="https://farm6.staticflickr.com/5582/14653735848_8de88d69c4_o.png"></p>
<p>Finally, the last couple of steps consist of assigning the quotas per user and / or group with the quotatool command (note that this task can also be performed by using edquota, but quotatool is more straightforward and less error-prone).</p>
<p>To set the soft limits to 4 MB and the hard limit to 5 MB for the user called xmodulo, and 10 MB / 15 MB for the xmodulo group:</p>
<pre>
# quotatool -u xmodulo -bq 4M -l '5 Mb' /home 
# quotatool -g xmodulo -bq 10M -l '15 Mb' /home
</pre>

<p><img src="https://farm4.staticflickr.com/3888/14653806037_5438b5034e_z.jpg"></p>
<p>And we can see the results in Windows 7 (3.98 MB free of 4.00 MB):</p>
<p><img src="https://farm4.staticflickr.com/3919/14653805967_c2b1551869_o.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/08/12/how-to-set-up-a-samba-file-server-to-use-with-windows-clients/" data-id="cm50h3r7m001myfhtv49mrd39" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/08/12/how-to-set-up-a-samba-file-server-to-use-with-windows-clients/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-what-are-useful-online-tools-for-linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/12/what-are-useful-online-tools-for-linux/" class="article-date">
  <time datetime="2014-08-11T16:00:00.000Z" itemprop="datePublished">2014-08-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/12/what-are-useful-online-tools-for-linux/">What are useful online tools for Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>As you know, GNU Linux is much more than just an OS. There is literally a whole sphere on the Internet dedicated to the penguin OS.</em></p>
<p>As you know, GNU Linux is much more than just an OS. There is literally a whole sphere on the Internet dedicated to the penguin OS. If you read this post, you are probably inclined towards reading about Linux online. Among all the pages that you can find on the subject, there are a couple of websites that every Linux adventurer should have in his bookmarks. These websites are more than just tutorials or reviews. They are real tools that you can access from anywhere and share with everyone. So today I shall propose you a non-exhaustive list of sixteen websites that should be in your bookmarks. Some of them can also be useful for Windows or Mac users: that’s the extent of their reach.</p>
<h3>1. <a href="ExplainShell.com">ExplainShell.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3841/14517716647_3b6a1a564d_z.jpg"></p>
<p>If you are interested in Linux command line, you should use this website. If you are not interested in Linux command line, you should use it even more as it will explain in detail how a command works. This could prevent you from launching a command detrimental to your computer, and is a good way to learn with a great interface.</p>
<h3>2. <a href="BashrcGenerator.com">BashrcGenerator.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3900/14703872782_033e5acdb8_z.jpg"></p>
<p>If you want to begin with Linux command line, or if you want to quickly get a customized shell prompt but not sure how, this website will generate for you PS1 prompt code to place your .bashrc file in your home directory. You can drag and drop the elements that you would like to see in your prompt, like your username and the current time, and the website will write the code for you. It’s easy and very readable. Definitely a must for the lazy.</p>
<h3>3. <a href="Vim-adventures.com">Vim-adventures.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3838/14681149696_0c533fd6de_z.jpg"></p>
<p>I only recently discovered this website, but it already sucked in many hours of my life. In short: a RPG game with Vim commands. Move your character in the isometric levels with the ‘h,j,k,l’ keys, gain new commands/abilities, collect keys, and learn how to use Vim proficiently very quickly.</p>
<h3>4. <a href="Try.Github.com">Try Github</a></h3>

<p><img src="https://farm4.staticflickr.com/3874/14517499739_0452848d68_z.jpg"></p>
<p>The pitch is simple: learn Git in 15 minutes. This website simulates a console, and walks you though the steps of collaborative editing. The interface is very stylish and the intention is worthy. The only downside is for the Git allergic. But it is definitely a good skill to have, and a good place to learn it.</p>
<h3>5. <a href="Shortcutfoo.com">Shortcutfoo.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3906/14517499799_f142ea37cb_z.jpg"></p>
<p>Another shortcut database, shortcutfoo is a bit more standard in its way to present its content to the user, but definitely more straight-forward than funny mini-games. The shortcuts of several programs are available and grouped by categories. As it might not be super complete for software like Vim, which is completely reliant on shortcuts, it is perfect for giving a quick tip or a general overview.</p>
<h3>6. <a href="#">GitHub Free Programming Books</a></h3>

<p><img src="https://farm4.staticflickr.com/3867/14517499989_408a28d8be_z.jpg"></p>
<p>As you might guess from the URL, this is a collection of free online books about programming, written collaboratively using Git. The content is awesome and the authors deserve to be praised for such work. It might not be the easiest read at first, but it is one of the most instructive for sure. We can only hope that the movement will keep growing.</p>


<h3>7. <a href="Collabedit.com">Collabedit.com</a></h3>

<p><img src="https://farm3.staticflickr.com/2940/14681150086_2d169d67f9_z.jpg"></p>
<p>If you ever plan on giving a phone interview, you should check out collabedit beforehand. It allows you to create a document, select the programming language that you want to write in, and then share that document via the URL. The people opening the link will be able to freely interact in real time with the text, allowing you to judge their programming skills or just exchange snippets. It even comes with the proper syntax highlighting and a chat widget. In other words, it is the instant-Google Document of programmers.</p>


<h3>8. <a href="Cpp.sh">Cpp.sh</a></h3>

<p><img src="https://farm4.staticflickr.com/3840/14700981001_af3ac40b65_z.jpg"></p>
<p>This is one of those websites that extend beyond just Linux, but it is so useful that it deserves its place here. In short, an online development environment for C++. Just write your code in your navigator and run it. As a bonus, you get an auto-indentation feature, Ctrl+Z, and the possibility to share the URL with your buddy. This is just one of those crazy things that you can do from a simple browser.</p>


<h3>9. <a href="Copy.sh">Copy.sh</a></h3>

<p><img src="https://farm4.staticflickr.com/3883/14517479870_da521931eb_z.jpg"></p>
<p>In continuation with crazy things that you can do from your browser, copy.sh lets you run a virtual machine online. Just that. It gained fame relatively recently, but the idea is just insane. From the navigator you can select among the defaults virtual images to run, or upload your own iso file. The code for that feat has been shared on GitHub. Just amazing.</p>


<h3>10. <a href="Commandlinefu.com">Commandlinefu.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3887/14517495938_ca3b831ca9_z.jpg"></p>
<p>We all keep a big snippet of command-line “gems” on our computer. commandlinefu’s goal is to release those snippets to the world. As a collaborative database, it resembles the Wikipedia of the command line. Everyone is free to register and post their favorite command on the website for everyone else to see. You will then be able to access that knowledge from everywhere and share it with everyone. If you are interested in mastering the shell, commandlinefu also proposes great features like random commands and a news feed to learn something new every day.</p>


<h3>11. <a href="Alias.sh">Alias.sh</a></h3>

<p><img src="https://farm4.staticflickr.com/3868/14701762124_a7b3547aca_z.jpg"></p>
<p>Another collaborative database, alias.sh (I love the URL) is a bit like commandlinefu but for shell aliases. You can share and discover useful aliases which will make your CLI experience so much better. I personally like the alias to get the dimensions of a picture.  </p><br><pre><br>1 function dim(){ sips $1 -g pixelWidth -g pixelHeight }<br></pre><br><p>All the seconds you save with alias.sh probably accumulate with time, and turn to years by the end of your life.</p>


<h3>12. <a href="Distrowatch.com">Distrowatch.com</a></h3>

<p><img src="https://farm3.staticflickr.com/2910/14681149996_50a45bff78_z.jpg"></p>
<p>Who does not know Distrowatch? Besides giving a precise ranking of Linux distributions based on their website popularity, Distrowatch is also a very useful database. Whether you are looking for a new distribution to try, or just curious, it presents an exhaustive account of every Linux you can find, with information like which default desktop environment it uses, or package system, or its default applications. And all the versions, and with easily accessible download links. In a word, the Linux database.</p>


<h3>13. <a href="Linuxmanpages.com">Linuxmanpages.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3911/14704165765_8e30cb3d3f_z.jpg"></p>
<p>Everything is in the URL: access the manual pages for popular commands from anywhere. Not really sure if this would actually be useful for Linux users as you can access that from your actual terminal, but the intent is remarkable.</p>


<h3>14. <a href="AwesomeCow.com">AwesomeCow.com</a></h3>

<p><img src="https://farm6.staticflickr.com/5558/14704165965_02b10ee293_z.jpg"></p>
<p>This is maybe a bit less hardcore Linux, but definitely useful to some. Awesomecow is a search engine for finding alternatives to Windows software on Linux. It can be helpful for anyone migrating to the penguin, or nostalgic of a Windows program. I see this as a strength, showing that Linux can compete with the professional spheres when it comes sot software quality. Or at least try to.</p>


<h3>15. <a href="PenguSpy.com">PenguSpy.com</a></h3>

<p><img src="https://farm4.staticflickr.com/3904/14517495728_f6877e8e3b_z.jpg"></p>
<p>Before Steam started to show up on Linux, gaming was probably one of the penguin’s weakness. But the website penguspy made the effort of fighting that weakness by collecting all Linux compatible games in a database with a sexy interface. Games can be sorted by categories, release dates, ratings, etc. I really hope that websites like this are not going to disappear because of Steam as it remains one of my favorites of this list.</p>


<h3>16. <a href="http://lxr.free-electrons.com/" target="_blank" rel="noopener">Linux Cross Reference by Free Electrons</a></h3>

<p><img src="https://farm4.staticflickr.com/3913/14712049464_6b666e2cfa_z.jpg"></p>
<p>Finally, for all the experts and the curious, lxr is the anagram from Linux Cross Reference, and allows us to interactively view the Linux Kernel code online. The navigation is made easy via identifiers, and you can compare the different versions of the files with a standard diff markup. The interface is sober and straight-forward, and this is just a website that perfectly illustrates the concept of open source.</p>

<p>To conclude, there are a lot more websites which deserve to be listed, and this might be a topic for a part two to this post. But this is a good start. It serves as an appetizer to what can be found online as tools for Linux users. If you have any other pages that you would like to share, following this thematic, do so in the comments. And maybe contribute to a sequel to this list.</p>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/08/12/what-are-useful-online-tools-for-linux/" data-id="cm50h3r7n001oyfht47q0iq04" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/08/12/what-are-useful-online-tools-for-linux/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-handle-photos" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/10/python-handle-photos/" class="article-date">
  <time datetime="2014-08-09T16:00:00.000Z" itemprop="datePublished">2014-08-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/10/python-handle-photos/">Python: handle photos</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>Some ways to handle photos in Python</em></p>
<pre>

#coding=utf-8
import Image
import urllib2
import StringIO
impoert os

#change photo size
def resize_img(img_path):
    try:
        img=Image.open(img_path)
        (width,height)=img.size
        new_width=200
        new_height=height*new_width/width
        out=img.resize((new_width,new_height),Image.ANTIALIAS)
        ext=os.path.splitext(img_path)[1]
        new_file_name='%s%s' % ('small',ext)
        out.save(new_file,quality=95)
    except Exception,e:
        print e

</pre>

<pre>
#change photo type
def change_img_type(img_path):
    try:
        img=Image.open(img_path)
        img.save('new_type.png')
    except Exception,e:
        print e

</pre>

<pre>

#deal with photo from remote
def handle_remote_img(img_url):
    try:
        request=urllib2.Request(img_url)
        img_data=urllib2.urlopen(request).read()
        img_buffer=StringIO.StringIO(img_data)
        img=Image.dopen(img_buffer)
        img.save('remote.jpg')
        (width,height)=img.size
        out=img.resize((200,height*200/width),Image.ANTIALITS)
        out.save('remote_small.jpg')
    except Exception,e:
        print e

</pre>

<pre>

if __name__=="__main__":
    img_path='linuxany.jpg'
    resize_img(img_path)
    change_img_type(img_path)
    img_url="http://img.****"
    handle_remote_img(img.url)
</pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/08/10/python-handle-photos/" data-id="cm50h3r7g001gyfhtmq15weg9" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/08/10/python-handle-photos/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-lambda-reduce" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/10/python-lambda-reduce/" class="article-date">
  <time datetime="2014-08-09T16:00:00.000Z" itemprop="datePublished">2014-08-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/10/python-lambda-reduce/">Python: lambda reduce</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>how to use lambda and reduce in python</em></p>
<p>lambda:<br>一句话函数：</p>
<pre>
    linuxany=lambda x,y: x+y
</pre>
#给ff传两个参数，bda定的x+y
<pre>
    print linuxany(2,3)  # print 5
</pre>

<p>reduce内建函数是一个二来将一个数据集合（链表，元组等）中的所有数据进行下列操作：用传给reduce中的函数func()（必须是一个二元操作函数）先对集合中的第1，2个数据进行操作，得到的结果再与第3个数据用func()函数运算，最后得到一个结果。<br>如：<br>先定义一个二元操作函数</p>
<pre>
    def linuxany(x,y):
        return x+y
        reduce(linuxany,(1,2,3,4,5))
</pre>

<p>lambda和reduce结合起来使用：</p>
<pre>
    print reduce(lambda x,y:x+y,range(10))
</pre>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/08/10/python-lambda-reduce/" data-id="cm50h3r7h001iyfhtb6t7ak0y" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/08/10/python-lambda-reduce/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-read--open-a-csv-file--randomly-select-an-entry" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/04/read--open-a-csv-file--randomly-select-an-entry/" class="article-date">
  <time datetime="2014-08-03T16:00:00.000Z" itemprop="datePublished">2014-08-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/04/read--open-a-csv-file--randomly-select-an-entry/">Read &amp; Open a CSV File &amp; Randomly Select an Entry</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>Read &amp; Open a CSV File &amp; Randomly Select an Entry</em></p>
<p>This is following the <a href="https://www.youtube.com/watch?v=NUVblHTElTk&amp;index=3&amp;list=PLEsfXFp6DpzR6FatOy4RtoXfu4PeYO_RL" target="_blank" rel="noopener">https://www.youtube.com/watch?v=NUVblHTElTk&amp;index=3&amp;list=PLEsfXFp6DpzR6FatOy4RtoXfu4PeYO_RL</a>.</p>
<pre>

#-*-coding=utf-8-*- 
import os
import random
import csv
import string

def get_file_path(filename):
    currentdirpath=os.getcwd()
    file_path=os.path.join(os.getcwd(),filename)
    return file_path

path=get_file_path('choice.csv')

def get_random_string():
    rnstring=''
    for i in range(0,4)
         rnstring += random.choice(string.ascii_letters)
     return rnstring

def read_csv(filepath):
    emails={}
     i=0
    with open(filepath,'rU') as csvfile:
         reader = csv.reader(csvfile)
         for row in reader:
             if not 'Email Address' in row:
                 email, domain = row[0].split('@')
                 fake_email=email[:4] + get_random_string() + "@" + domain
                 emails[i] = fake_email
                 i += 1
     return emails

def get_winner():
     emails=read_csv(path)
     ran_num=random.randint(0,len(emails)-1)
     winner=emails[ran_num]
     print winner,ran_num
get_winner()

</pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/08/04/read--open-a-csv-file--randomly-select-an-entry/" data-id="cm50h3r7d001cyfhtuhdrqwq9" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/08/04/read--open-a-csv-file--randomly-select-an-entry/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-hadoop-pusehon--hwritedoop-sap-reduce" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/28/hadoop-pusehon--hwritedoop-sap-reduce/" class="article-date">
  <time datetime="2014-07-27T16:00:00.000Z" itemprop="datePublished">2014-07-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/28/hadoop-pusehon--hwritedoop-sap-reduce/">hadoop用純 python 寫 hadoop 的 map reduce 程式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>hadoop用純 python 寫 hadoop 的 map reduce 程式</em></p>
<p>好繞口的標題:)。hadoop 是 java 寫成的，但是並不是只能用 java 才能在 hadoop 裡面執行程式。但是第一個的觀念要有的是，程式的執行環境，就是在 java VM 裡面。所以，在 hadoop 文件裡介紹的 python 程式，要執行的時候，是用 jython 轉成 java jar，然後交由 hadoop framework 來執行。所以，以此類推，任何語言有能力轉成 java jar 的，應該都可以寫出程式讓 hadoop framework 執行。</p>
<p>回頭講 python。用慣 python 的人，應該是不太習慣 jython 的(我就是)。這兩個的確有些差別，讓我無法適應(ironpython 也是)。所以，Noll 先生就介紹了如何用純 python 在 hadoop framework 執行。</p>
<p>他所利用的是，hadoop 的一個 Streaming API 收發串流資料的能力，且 hadoop 可存取 stdin 及 stdout 。因此把它們當做通道，把 hadoop framework 與 python 執行期結合起來。所以，接下來要注意的是，mapper.py、reducer.py 是放在本機環境，而資料是放在 hadoop 環境裡。稍不注意放錯位置就會無法執行。</p>
<p>準備環境：</p>
<ul><br>    <li>hadoop 環境，照之前的文章，</li><br>    <li>準備以下的程式<br>    <ul><br>        <li>mapper.py 放在 /home/hduser/mapper.py (記得 chmod +x)</li><br><pre><br>#!/usr/bin/env python<br>import sys<br># input comes from STDIN (standard input)<br>for line in sys.stdin:<br>    # remove leading and trailing whitespace<br>    line = line.strip()<br>    # split the line into words<br>    words = line.split()<br>    # increase counters<br>    for word in words:<br>        # write the results to STDOUT (standard output);<br>        # what we output here will be the input for the<br>        # Reduce step, i.e. the input for reducer.py<br>        #<br>        # tab-delimited; the trivial word count is 1<br>    print ‘%s\t%s’ % (word, 1)<br></pre><br>        <li>reducer.py 放在 /home/hduser/reducer.py (記得 chmod +x)</li><br><pre><br>#!/usr/bin/env python<br>from operator import itemgetter<br>import sys<br>current_word = None<br>current_count = 0<br>word = None<br># input comes from STDIN<br>for line in sys.stdin:<br>    # remove leading and trailing whitespace<br>    line = line.strip()<br>    # parse the input we got from mapper.py<br>    word, count = line.split(‘\t’, 1)<br>    # convert count (currently a string) to int<br>    try:<br>        count = int(count)<br>    except ValueError:<br>        # count was not a number, so silently<br>        # ignore/discard this line<br>        continue<br>    # this IF-switch only works because Hadoop sorts map output<br>    # by key (here: word) before it is passed to the reducer<br>    if current_word == word:<br>        current_count += count<br>    else:<br>        if current_word:<br>            # write result to STDOUT<br>            print ‘%s\t%s’ % (current_word, current_count)<br>        current_count = count<br>        current_word = word<br># do not forget to output the last word if needed!<br>if current_word == word:<br>      print ‘%s\t%s’ % (current_word, current_count)<br></pre><br>    </ul>

<p></p></li></ul><p></p>
<p>Noll 先生還很好心地建議，利用一點小手法測試一下 mapper.py 及 reducer.py，免得執行完不如預期，牽拖別人。</p>
<pre>

# very basic test  hduser@ubuntu:~$ echo "foo foo quux labs foo bar quux" | /home/hduser/mapper.py  
foo     1  
foo     1  
quux    1  
labs    1  
foo     1  
bar     1  
quux    1 
hduser@ubuntu:~$ echo "foo foo quux labs foo bar quux" | /home/hduser/mapper.py | sort -k1,1 | /home/hduser/reducer.py  
bar     1  
foo     3  
labs    1  
quux    2 
# using one of the ebooks as example input  
# (see below on where to get the ebooks)  
hduser@ubuntu:~$ cat /tmp/gutenberg/20417-8.txt | /home/hduser/mapper.py  
The     1  
Project 1  
Gutenberg       1  
EBook   1  
of      1  
[...]  
(you get the idea)
</pre>

<p>好了，程式就這麼簡單。接下來要試著讓它跑。要準備材料。跟之前測試的一樣，到 Project Gutenberg 下載三本書，要下載文字版，UTF-8 編碼的檔案。(Plain Text UTF-8)</p>
<p>The Outline of Science, Vol. 1 (of 4) by J. Arthur Thomson<br>The Notebooks of Leonardo Da Vinci<br>Ulysses by James Joyce</p>
<p>把文字檔放到 /tmp/gutenberg 目錄去。<br>然後，要把這三個檔案，放到 HDFS 去(也就是 Hadoop 環境的檔案區)</p>
<pre>
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -copyFromLocal /tmp/gutenberg /user/hduser/gutenberg  
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -ls  
Found 1 items  
drwxr-xr-x   - hduser supergroup          0 2010-05-08 17:40 /user/hduser/gutenberg  
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -ls /user/hduser/gutenberg  
Found 3 items  
-rw-r--r--   3 hduser supergroup     674566 2011-03-10 11:38 /user/hduser/gutenberg/pg20417.txt  
-rw-r--r--   3 hduser supergroup    1573112 2011-03-10 11:38 /user/hduser/gutenberg/pg4300.txt  -
-rw-r--r--   3 hduser supergroup    1423801 2011-03-10 11:38 /user/hduser/gutenberg/pg5000.txt  
hduser@ubuntu:/usr/local/hadoop$

</pre>

<p>然後，就是執行 mapreduce job 的時候，只有一行指令，當然參數很多，不要換行！</p>
<pre>
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop jar contrib/streaming/hadoop-*streaming*.jar 
-file /home/hduser/mapper.py    -mapper /home/hduser/mapper.py  -file /home/hduser/reducer.py   -reducer /home/hduser/reducer.py -input /user/hduser/gutenberg/* -output /user/hduser/gutenberg-output

</pre>

<p>執行完的結果會放在，執行範例如下：</p>
<pre>
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop jar contrib/streaming/hadoop-*streaming*.jar -mapper /home/hduser/mapper.py -reducer /home/hduser/reducer.py -input /user/hduser/gutenberg/* -output /user/hduser/gutenberg-output  
additionalConfSpec_:null  
null=@@@userJobConfProps_.get(stream.shipped.hadoopstreaming  
packageJobJar: [/app/hadoop/tmp/hadoop-unjar54543/]  
[] /tmp/streamjob54544.jar tmpDir=null  
[...] INFO mapred.FileInputFormat: Total input paths to process : 7  
[...] INFO streaming.StreamJob: getLocalDirs(): [/app/hadoop/tmp/mapred/local]  
[...] INFO streaming.StreamJob: Running job: job_200803031615_0021  
[...]  
[...] INFO streaming.StreamJob:  map 0%  reduce 0%  
[...] INFO streaming.StreamJob:  map 43%  reduce 0%  
[...] INFO streaming.StreamJob:  map 86%  reduce 0%  
[...] INFO streaming.StreamJob:  map 100%  reduce 0%  
[...] INFO streaming.StreamJob:  map 100%  reduce 33%  
[...] INFO streaming.StreamJob:  map 100%  reduce 70%  
[...] INFO streaming.StreamJob:  map 100%  reduce 77%  
[...] INFO streaming.StreamJob:  map 100%  reduce 100%  
[...] INFO streaming.StreamJob: Job complete: job_200803031615_0021  
[...] INFO streaming.StreamJob: Output: /user/hduser/gutenberg-output  hduser@ubuntu:/usr/local/hadoop$
</pre>

<p>執行完的結果在 HDFS 的 /user/hduser/gutenberg-output，用指令看一下結果的內容</p>
<pre>
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -ls /user/hduser/gutenberg-output  
Found 1 items  
/user/hduser/gutenberg-output/part-00000     &lt;r 1&gt;   903193  2007-09-21 13:00  
hduser@ubuntu:/usr/local/hadoop$  
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -cat /user/hduser/gutenberg-output/part-00000  
"(Lo)cra"       1  
"1490   1  
"1498," 1  
"35"    1  
"40,"   1  
"A      2  
"AS-IS".        2  
"A_     1  
"Absoluti       1  
[...]  
hduser@ubuntu:/usr/local/hadoop$
</pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/07/28/hadoop-pusehon--hwritedoop-sap-reduce/" data-id="cm50h3r7e001eyfhtjtcftn5r" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/07/28/hadoop-pusehon--hwritedoop-sap-reduce/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-tkinter-canvas-sample" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/27/tkinter-canvas-sample/" class="article-date">
  <time datetime="2014-07-26T16:00:00.000Z" itemprop="datePublished">2014-07-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/27/tkinter-canvas-sample/">Tkinter Canvas Sample</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>A sample for tkinter canvas.</em></p>
<pre>
import Tkinter
root = Tkinter.Tk(0
canvas=Tkinter.Canvas(root,width=600,height=400,bg='white')

canvas.create_text(302,77,text='Use Canvas', fill='gray')
canvas.create_text(300,75,text='Use Canvas',fill='blue')
canvas.create_polygon(290,114,316,114,330,130,310,146,284,146,270,130)
canvas.create_oval(280,120,320,140,fill='white')
canvas.create_line(250,130,350,130)
canvas.create_line(300,100,300,160)
canvas.create_arc(100,200,500,400,start=0,extent=240,fill='pink')
canvas.create_arc(103,203,500,400,start=241,extent=118,fill='red')
canvas.pack()

root.mainloop()
</pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/07/27/tkinter-canvas-sample/" data-id="cm50h3r7a0018yfhtqoq0otcd" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/07/27/tkinter-canvas-sample/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-a-sample-game-use-pygame" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/27/a-sample-game-use-pygame/" class="article-date">
  <time datetime="2014-07-26T16:00:00.000Z" itemprop="datePublished">2014-07-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/27/a-sample-game-use-pygame/">A Sample Game Use Pygame</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>a game by use pygame.</em></p>
<pre>
#-*-coding=utf-8-*-

import sys
import pygame
import threading
import random

class Game:
    def __init__(self):
        pygame.init()
        self.screen=pygame.display.set_mode((800,600))
        pygame.display.set_caption('python game')
        self.imgae=[]
        self.imagerect=[]

        self.vs=pygame.image.load('image/vs.gif')
        self.o=pygame.image.load('image/o.gif')
        self.p=pygame.image.load('image/p.gif')
        self.u=pygame.image.load('iamge/o.gif')
        self.title=pygame.image.load('iamge/title.gif')
        self.start=pygame.image.load('image/start.gif')
        self.exit=pygame.image.load('iamge/exit.gif')

        for i in range(3):
            gif=pygame.image.load('image/' + str(i) + '.gif')
            self.image.append(gif)
        for i in range(3):
            image=self.image[i]
            rect=image.get_rect()
            rect.left=200 * (i+1) + rect.left
            rect.top=400
            self.imagerect.append(rect)

    def Start(self):
        self.screen.blit(self.title,(200,100,400,140))
        self.screen.blit(self.start,(350,300,100,50))
        self.screen.blit(self.exit,(350,400,100,50))
        pygame.display.flip()
        start=1
        while start:
            for event in pygame.event.get():
                if event.type == pygame.QUIT:
                    sys.exit()
                elif event.type == pygame.MOUSEBUTTONDOWN:
                    if self.isStart() == 0:
                        start=0
                    elif self.isStart(0 == 1:
                        sys.exit()
                    else:
                        pass
        self.run()

    def run(self):
        self.screen.fill((0,0,0))
        for i in range(3):
            self.screen.blit(self.image[i],self.imagerect[i])
        pygame.display.flip()
        while True:
            for event in pygame.event.get():
                if event.type == pygame.Quit:
                    sys.exit()
                elif event.type == pygame.MOUSEBUTTONDOWN:
                    self.OnMouseButDown()
                else:
                    pass

    def isStart(self):
        pos = pygame.mouse.get_pos()
        if pos[0] > 350 and pos[0] < 450:
            if pos[1] > 300 and pos[1] < 350:
                return 0
            elif pos[1] > 400 and pos[1] < 450:
                return 1
            else:
                return 2
        else:
            return 2

    def OnMouseButDown(self)
        self.screen.blit(self.vs,(300,150,140,140))
        pos=pygame.mouse.get_pos()
        if pos[1] > 400 and pos[1] < 500:
            if pos[0] > 200 and pos[0] < 340:
                self.screen.blit(self.image[0],(150,150,140,140))
                self.isWin(0)
            elif pos[0] > 400 and pos[0] < 540:
                self.screen.blit(self.image[1],(150,150,140,140))
                self.isWin(1)
            elif pos[0] > 600 and pos[0] < 740:
                self.screen.blit(self.image[2],(150,150,140,140))
                self.isWin(2)
            else:
                pass

    def isWin(self,value):
        num=random.randint(0,2)
        self.screen.blit(self.image[num],(450,150,590,240))
        pygame.display.flip()

        if num == value:
            self.screen.blit(self.o,(220,10,140,70))
            pygame.display.flip()
        elif num < value:
            if num == 0:
                if value == 2:
                    self.screen.blit(self.u,(220,10,140,70))
                else:
                    self.screen.blit(self.p,(220,10,140,70))
                pygame.display.flip()
            else:
                self.screen.blit(self.u,(220,10,140,70))
                pygame.display.flip()
        else:
            if num == 2:
                if value == 1:
                    self.screen.blit(self.u,(220,10,140,70))
                else:
                    self.screen.blit(self.p,(220,10,140,70))
                pygame.display.flip()
            else:
                self.screen.blit(self.u,(220,10,140,70))
                pygame.display.flip()

game=Game()
game.Start()

</pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/07/27/a-sample-game-use-pygame/" data-id="cm50h3r7b001ayfht3tty59eu" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/07/27/a-sample-game-use-pygame/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-beautifulsoup-basic" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/13/beautifulsoup-basic/" class="article-date">
  <time datetime="2014-07-12T16:00:00.000Z" itemprop="datePublished">2014-07-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/13/beautifulsoup-basic/">BeautifulSoup Basic</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>What is BeautifulSoup? BeautifulSoup is a Python library from <a href="http://www.crummy.com" target="_blank" rel="noopener">www.crummy.com</a> </em></p>
<p></p><h3>What is BeautifulSoup?</h3><br>BeautifulSoup is a Python library from <a href="http://www.crummy.com" target="_blank" rel="noopener">www.crummy.com</a> <p></p>
<p></p><h3>What can it do</h3><br>On their website they write “Beautiful Soup parses anything you give it, and does the tree traversal stuff for you. <p></p>
<p><b>You can tell it to:</b></p>
<p>“Find all the links”</p>
<p>“Find all the links of class externalLink”</p>
<p>“Find all the links whose urls match “foo.com”</p>
<p>“Find the table heading that’s got bold text, then give me that text.”” </p>
<p></p><h3>BeautifulSoup Example</h3><br>In this example, we will try and find a link (a tag) in a webpage. <p></p>
<p>Before we start, we have to import two modules. (BeutifulSoup and urllib2). </p>
<p>Urlib2 is used to open the URL we want. </p>
<p>We will use the soup.findAll method to search through the soup object to match fortext and html tags within the page. </p>
<pre>
from BeautifulSoup import BeautifulSoup
import urllib2

url = urllib2.urlopen("http://www.python.org")
content = url.read()
soup = BeautifulSoup(content)
links = soup.findAll("a")
</pre>

<p>Output</p>
<p><pre><br>That will print out all the elements in python.org with an “a” tag. </pre></p>
<p>(The “a” tag defines a hyperlink, which is used to link from one page to another.)<br></p>
<p></p><h3>BeautifulSoup Example 2</h3><br>To make it a bit more useful, we can specify the URL’s we want to return.  <p></p>
<p><pre><br>from BeautifulSoup import BeautifulSoup<br>import urllib2<br>import re</pre></p>
<p>url = urllib2.urlopen(“<a href="http://www.python.org&quot;" target="_blank" rel="noopener">http://www.python.org&quot;</a>)<br>content = url.read()<br>soup = BeautifulSoup(content)<br>for a in soup.findAll(‘a’,href=True):<br>    if re.findall(‘python’, a[‘href’]):<br>        print “Found the URL:”, a[‘href’]<br><br>Further Reading</p>
<p>I recommend that you head over to <a href="http://www.crummy.com" target="_blank" rel="noopener">http://www.crummy.com</a> to read more about what you can do with this awesome module.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/07/13/beautifulsoup-basic/" data-id="cm50h3r790016yfhtlblajl48" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/07/13/beautifulsoup-basic/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-remote-control-with-telnetlib-python-recipe" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/07/12/remote-control-with-telnetlib-python-recipe/" class="article-date">
  <time datetime="2014-07-11T16:00:00.000Z" itemprop="datePublished">2014-07-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/07/12/remote-control-with-telnetlib-python-recipe/">Remote control with telnetlib (Python recipe)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><em>Remote control with telnetlib (Python recipe)</em></p>
<p>Send commands to one or more logins using Python’s standard telnetlib module.</p>
<p><pre></pre></p>
<h1 id="auto-telnet-py-remote-control-via-telnet"><a href="#auto-telnet-py-remote-control-via-telnet" class="headerlink" title="auto_telnet.py - remote control via telnet"></a>auto_telnet.py - remote control via telnet</h1><p>import os, sys, string, telnetlib<br>from getpass import getpass</p>
<p>class AutoTelnet:<br>    def <strong>init</strong>(self, user_list, cmd_list, **kw):<br>        self.host = kw.get(‘host’, ‘localhost’)<br>        self.timeout = kw.get(‘timeout’, 600)<br>        self.command_prompt = kw.get(‘command_prompt’, “$ “)<br>        self.passwd = {}<br>        for user in user_list:<br>            self.passwd[user] = getpass(“Enter user ‘%s’ password: “ % user)<br>        self.telnet = telnetlib.Telnet()<br>        for user in user_list:<br>            self.telnet.open(self.host)<br>            ok = self.action(user, cmd_list)<br>            if not ok:<br>                print “Unable to process:”, user<br>            self.telnet.close()</p>
<pre><code>def action(self, user, cmd_list):
    t = self.telnet
    t.write(&quot;\n&quot;)
    login_prompt = &quot;login: &quot;
    response = t.read_until(login_prompt, 5)
    if string.count(response, login_prompt):
        print response
    else:
        return 0
    password_prompt = &quot;Password:&quot;
    t.write(&quot;%s\n&quot; % user)
    response = t.read_until(password_prompt, 3)
    if string.count(response, password_prompt):
        print response
    else:
        return 0
    t.write(&quot;%s\n&quot; % self.passwd[user])
    response = t.read_until(self.command_prompt, 5)
    if not string.count(response, self.command_prompt):
        return 0
    for cmd in cmd_list:
        t.write(&quot;%s\n&quot; % cmd)
        response = t.read_until(self.command_prompt, self.timeout)
        if not string.count(response, self.command_prompt):
            return 0
        print response
    return 1
</code></pre><p>if <strong>name</strong> == ‘<strong>main</strong>‘:<br>    basename = os.path.splitext(os.path.basename(sys.argv[0]))[0]<br>    logname = os.environ.get(“LOGNAME”, os.environ.get(“USERNAME”))<br>    host = ‘localhost’<br>    import getopt<br>    optlist, user_list = getopt.getopt(sys.argv[1:], ‘c:f:h:’)<br>    usage = “””<br>usage: %s [-h host] [-f cmdfile] [-c “command”] user1 user2 …<br>    -c  command<br>    -f  command file<br>    -h  host  (default: ‘%s’)</p>
<p>Example:  %s -c “echo $HOME” %s<br>“”” % (basename, host, basename, logname)<br>    if len(sys.argv) &lt; 2:<br>        print usage<br>        sys.exit(1)<br>    cmd_list = []<br>    for (opt, optarg) in optlist:<br>        if opt == ‘-f’:<br>            for r in open(optarg).readlines():<br>                if string.rstrip(r):<br>                    cmd_list.append(r)<br>        elif opt == ‘-c’:<br>            command = optarg<br>            if command[0] == ‘“‘ and command[-1] == ‘“‘:<br>                command = command[1:-1]<br>            cmd_list.append(command)<br>        elif opt == ‘-h’:<br>            host = optarg<br>    autoTelnet = AutoTelnet(user_list, cmd_list, host=host)</p>
<p><br>Python’s telnetlib permits users to easily automate access to telnet servers, even from non-Unix machines.</p>
<p>As an alternative to the popen() functions, telnetlib is probably a handy technique to have in your sysadmin toolbox.</p>
<p>Production code will generally be more robust, but this example should be enough to get anyone started in the right direction.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://tonytan748.github.io/2014/07/12/remote-control-with-telnetlib-python-recipe/" data-id="cm50h3r6w000wyfht7c4mk7ma" class="article-share-link">Share</a>
      
        <a href="https://tonytan748.github.io/2014/07/12/remote-control-with-telnetlib-python-recipe/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/12/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/14/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Github/">Github</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Karrigell/">Karrigell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/VIM/">VIM</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/conda/">conda</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/django/">django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ffmpeg/">ffmpeg</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/freeswitch/">freeswitch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/jekyll/">jekyll</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/kivy/">kivy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/linux/mac/">mac</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/nginx/">nginx</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/normal/">normal</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/sqlalchemy/">sqlalchemy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system/">system</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/tornado/">tornado</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/ubuntu/">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/conda/">conda</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django/">django</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/django-celery/">django-celery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ffmpeg/">ffmpeg</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/freeswitch/">freeswitch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/other/">other</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlalchemy/">sqlalchemy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/system/">system</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tornado/">tornado</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/conda/" style="font-size: 10px;">conda</a> <a href="/tags/django/" style="font-size: 18px;">django</a> <a href="/tags/django-celery/" style="font-size: 10px;">django-celery</a> <a href="/tags/ffmpeg/" style="font-size: 10px;">ffmpeg</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/freeswitch/" style="font-size: 10px;">freeswitch</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/go/" style="font-size: 14px;">go</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/linux/" style="font-size: 16px;">linux</a> <a href="/tags/mac/" style="font-size: 10px;">mac</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/other/" style="font-size: 12px;">other</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/sqlalchemy/" style="font-size: 10px;">sqlalchemy</a> <a href="/tags/system/" style="font-size: 12px;">system</a> <a href="/tags/tornado/" style="font-size: 10px;">tornado</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/08/">August 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/07/">July 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/06/">June 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/05/">May 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/04/">April 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/03/">March 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/12/">December 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/11/">November 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/10/">October 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/09/">September 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/05/">May 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">January 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">November 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">May 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">July 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">December 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">November 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/09/">September 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/08/">August 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">July 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">June 2014</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/23/Python-Typing类型提示/">Python Typing类型提示</a>
          </li>
        
          <li>
            <a href="/2024/12/23/Python-Tempfile临时文件系统对象/">Python Tempfile临时文件系统对象</a>
          </li>
        
          <li>
            <a href="/2024/12/23/Python-Pathlib处理文件路径库的使用/">Python Pathlib处理文件路径库的使用</a>
          </li>
        
          <li>
            <a href="/2024/08/31/在ubuntu上的18个非常实用的命令行工具软件/">在ubuntu上的18个非常实用的命令行工具软件</a>
          </li>
        
          <li>
            <a href="/2024/08/20/什么是动态规划？在Python中如何利用动态规划解决实际问题？/">什么是动态规划？在Python中如何利用动态规划解决实际问题？</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2024 Tony Tan<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    
<script>
  var disqus_shortname = 'TonyTan';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>